function RunFilters(n,t,i){generateValueInput=n||GenerateValueSelection;generateActingInput=t||GenerateActingSelection;generateFilters=i||FilterGen;$(".delete-variable").on("click",function(n){DeleteVariable($(this).parent(),n)});$("#unGroup").on("click",function(n){n.preventDefault();$(".filter").css("background-color","inherit");$(".filter").find('input[name$="GroupNext"]').val("false");colorIndex=-1});$("#groupTogether").on("click",function(n){if(n.preventDefault(),$("input.groupNext:checked").length>1)colorIndex++;else return;colorIndex>=colors.length&&(colorIndex=0);var r=!1,u=!1,t=null,f=0,i=[];$("input.groupNext").each(function(){if(r&&($(this).is(":checked")||(u=!0)),$(this).is(":checked")&&!u){var n=$(this).parent().parent().parent();f++;r=!0;t=n.find('input[name$="GroupNext"]');t.val("true");n.css("background-color",colors[colorIndex]);i.push(n)}});f==1&&(i[0].css("background-color","inherit"),i[o].find("input.groupNext").val("false"));t.val("false");$("input.groupNext").prop("checked",!1)});$(".delete-statement").on("click",function(n){DeleteStatement($(this).parents("tr")[0],n)});$("#addStatement").on("click",function(){var t;filterIndex++;var r=new Filter,i=filterIndex+1,n='<tr class="filter" data-index="'+filterIndex+'"><td>';for(n+='<label><input type="checkbox" class="groupNext" value="true" /><\/label> <a href="#" class="delete-statement"><span class="glyphicon glyphicon-trash"><\/span><\/a>',n+='<input type="hidden" name="Filters['+filterIndex+'].GroupNext" value="false" />',n+='<input type="hidden" name="Filters['+filterIndex+'].UId" value="'+emptyGuid+'" />',n+='<input type="hidden" name="Filters['+filterIndex+'].Order" value="'+i+'" />',n+="<\/td>",n+='<td><select class="filter-link form-control" name="Filters['+filterIndex+'].Link">',n+='<option value="0">None<\/option>',n+='<option value="1">And<\/option>',n+='<option value="2">Or<\/option>',n+="<\/select><\/td>",n+="<td>",n+=generateActingInput(),n+="<\/td>",n+='<td><select class="filter-test form-control" name="Filters['+filterIndex+'].Test">',t=0;t<tests.length;t++)n+='<option value="'+tests[t].Index+'">'+tests[t].Name+"<\/option>";n+="<\/select><\/td>";n+="<td>";n+=generateValueInput("default",filterIndex,"");n+="<\/td>";n+="<\/tr>";$("#filterTable").children("tbody").append(n);$('.filter[data-index="'+filterIndex+'"]').find(".filter-actingon").on("change",function(){var n=parseInt($(this).parents("tr").attr("data-index"));ActingOnChange($('tr[data-index="'+n+'"]'),$(this))});$('.filter[data-index="'+filterIndex+'"]').find(".delete-statement").on("click",function(n){DeleteStatement($(this).parents("tr")[0],n)})})}function ActingOnChange(n,t){try{n.find(".rating").rating("destroy")}catch(u){}var i=n.find(".filter-value"),r=generateValueInput(t.val(),parseInt(n.attr("data-index")));$(i).replaceWith(r);try{n.find(".rating").rating();n.find(".datepicker").datetimepicker()}catch(u){}}function FillFilters(n){generateFilters(n)}function FilterGen(n){var r,t,i,u;for($("#filters").html(""),r=-1,t="",i=0;i<n.length;i++){for(r++,t+='<tr class="filter" data-index="'+r+'"><td>',t+='<label><input type="checkbox" class="groupNext" value="true" /><\/label> <a href="#" class="delete-statement"><span class="glyphicon glyphicon-trash"><\/span><\/a>',t+='<input type="hidden" name="Filters['+r+'].GroupNext" value="'+n[i].GroupNext+'" />',t+='<input type="hidden" name="Filters['+r+'].UId" value="'+n[i].UId+'" />',t+='<input type="hidden" name="Filters['+r+'].Order" value="'+n[i].Order+'" />',t+="<\/td>",t+='<td><select class="filter-link form-control" name="Filters['+r+'].Link">',t+='<option value="0"'+(n[i].Link==0?' selected="true"':"")+">None<\/option>",t+='<option value="1"'+(n[i].Link==1?' selected="true"':"")+">And<\/option>",t+='<option value="2"'+(n[i].Link==2?' selected="true"':"")+">Or<\/option>",t+="<\/select><\/td>",t+="<td>",t+=generateActingInput(n[i].ActingOn),t+="<\/td>",t+='<td><select class="filter-test form-control" name="Filters['+r+'].Test">',u=0;u<tests.length;u++)t+='<option value="'+tests[u].Index+'"'+(tests[u].Index==n[i].Test?' selected="true"':"")+">"+tests[u].Name+"<\/option>";t+="<\/select><\/td>";t+="<td>";t+=generateValueInput("default",r,n[i].Value);t+="<\/td>";t+="<\/tr>";$("#filterTable").children("tbody").append(t);$('.filter[data-index="'+r+'"]').find(".filter-actingon").on("change",function(){var n=parseInt($(this).parents("tr").attr("data-index"));ActingOnChange($('tr[data-index="'+n+'"]'),$(this))});$('.filter[data-index="'+r+'"]').find(".delete-statement").on("click",function(n){DeleteStatement($(this).parents("tr")[0],n)})}}function GenerateActingSelection(){var n='<select class="filter-actingon form-control" name="Filters['+filterIndex+'].ActingOn">',t;for(n+='<option value="email">Email<\/option>',n+='<option value="confirmation">Confirmation<\/option>',n+='<option value="status">Status<\/option>',n+='<option value="dateregistered">Date Registered<\/option>',n+='<option value="type">Type<\/option>',n+='<option value="audience">Audience<\/option>',n+='<option value="rsvp">RSVP<\/option>',t=0;t<components.length;t++)n+='<option value="'+components[t].UId+'">'+components[t].Name+"<\/option>";return n}function PopulateFilters(){var n=[];return $(".filter").each(function(){var i=$(this),t={};t.GroupNext=i.find('input[name$="GroupNext"]').val();t.UId=i.find('input[name$="UId"]').val();t.Order=i.find('input[name$="Order"]').val();t.Link=i.find(".filter-link").val();t.ActingOn=i.find(".filter-actingon").val();t.Test=i.find(".filter-test").val();t.Value=i.find(".filter-value").val();t.SortingId=-1;n.push(t)}),n}function DeleteStatement(n,t){t.preventDefault();$(n).remove();$(".filter").css("background-color","inherit");$(".filter").find('input[name$="GroupNext"]').val("false");colorIndex=-1;$("tr.filter").each(function(n){filterIndex=n;$(this).find("input").each(function(){var n=$(this).attr("name");typeof n!="undefined"&&(n=n.replace(/\[\d+\]/,"["+filterIndex+"]"),$(this).attr("name",n))});$(this).find('input[name$="Order"]').val(filterIndex+1)});filterIndex--}function DeleteVariable(n,t){t.preventDefault();n.remove();variableIndex=-1;$('#sortOn option[value="'+n.attr("data-id")+'"]').remove();$(".variable").each(function(){variableIndex++;$(this).find("input").attr("name","Variables["+variableIndex+"]")})}function GenerateValueSelection(n,t,i){var u,f,e,o,r;(typeof i=="undefined"||i===null)&&(i="");component=findComponent(n);type=n;component!==null&&(type=component.Type);u="";switch(type){case"audience":for(u+='<select class="filter-value form-control" name="Filters['+t+'].Value">',r=0;r<audiences.length;r++)u+='<option value="'+audiences[r].UId+'"'+(i==audiences[r].UId?'selected="true"':"")+">"+audiences[r].Name+"<\/option>";u+="<\/select>";break;case"type":for(u+='<select class="form-control filter-value" class="filter-value form-control" name="Filters['+t+'].Value">',r=0;r<types.length;r++)u+='<option value="'+types[r].Index+'"'+(i==types[r].Index?'selected="true"':"")+">"+types[r].Name+"<\/option>";u+="<\/select>";break;case"status":for(u+='<select class="filter-value form-control" name="Filters['+t+'].Value">',r=0;r<statusi.length;r++)u+='<option value="'+statusi[r].Index+'"'+(i==statusi[r].Index?'selected="true"':"")+">"+statusi[r].Name+"<\/option>";u+="<\/select>";break;case"rsvp":u+='<select class="filter-value form-control" name="Filters['+t+'].Value">';u+='<option value="true" '+(i=="true"?'selected="true"':"")+">Accepted<\/option>";u+='<option value="false" '+(i=="false"?'selected="true"':"")+">Declined<\/option>";u+="<\/select>";break;case"dateregistered":u+='<input class="filter-value datepicker form-control" name="Filters['+t+'].Value" value="" />';break;case"checkboxgroup":for(f=component.Items,u+='<select class="filter-value form-control" name="Filters['+t+'].Value">',r=0;r<f.length;r++)u+='<option value="'+f[r].UId+'" '+(i==f[r].UId?'selected="true"':"")+">"+f[r].Name+"<\/option>";u+="<\/select>";break;case"radiogroup":for(e=component.Items,u+='<select class="filter-value form-control" name="Filters['+t+'].Value">',r=0;r<e.length;r++)u+='<option value="'+e[r].UId+'" '+(i==e[r].UId?'selected="true"':"")+">"+e[r].Name+"<\/option>";u+="<\/select>";break;case"dropdowngroup":for(o=component.Items,u+='<select class="filter-value form-control" name="Filters['+t+'].Value">',r=0;r<o.length;r++)u+='<option value="'+o[r].UId+'" '+(i==o[r].UId?'selected="true"':"")+">"+o[r].Name+"<\/option>";u+="<\/select>";break;default:u+='<input type="text" class="filter-value form-control" name="Filters['+t+'].Value" value="'+i+'" />'}return u}function findComponent(n){for(var t=0;t<components.length;t++)if(components[t].UId==n)return components[t];return null}function generateFilterModal(){var n='<div class="modal fade" id="filterModal"><div class="modal-dialog modal-lg"><div class="modal-header"><h3 class="modal-title">Filters<\/h3><\/div>';n+='<div class="modal-body"><div class="add-padding-top text-color-1"><h4>Current Filters<\/h4><\/div>';n+='<div class="row color-grey-2 add-padding-vertical-5"><div class="col-sm-6"><div class="add-padding-vertical-5"><a href="#" id="groupTogether"><span class="glyphicon glyphicon-link"><\/span> Group Selected<\/a><\/div><\/div>';n+='<div class="col-sm-6"><div class="add-padding-vertical-5"><a href="#" id="unGroup"><span class="glyphicon glyphicon-link"><\/span> Ungroup All<\/a><\/div><\/div><\/div>';n+='<div class="row"><table class="table table-filter filter-table" id="filterTable">';n+="<thead><tr><th><\/th><th>Link<\/th><th>Variable<\/th><th>Test<\/th><th>Value<\/th><\/tr><\/thead>";n+='<tbody id="filters"><\/tbody><tfoot><tr><td colspan="5"><a href="#" id="addStatement"><span class="glyphicon glyphicon-small glyphicon-plus"><\/span> New Statement<\/a><\/td><\/tr><\/tbody>';n+='<\/table><\/div><\/div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Cancel<\/button><button type="button" class="btn btn-default" id="setFilters">Apply Filters<\/button>';n+="<\/div><\/div><\/div>";$("body").append(n)}var generateValueInput,generateActingInput,generateFilters,colors=["#FFFFB0","#B0B0FF","#68C473","#C468B9","#6669BA","#BAB766"],tests=[{Index:0,Name:"equals"},{Index:1,Name:"greater than"},{Index:2,Name:"greater than or equal"},{Index:3,Name:"less than"},{Index:4,Name:"less than or equal"},{Index:5,Name:"not equals"},{Index:6,Name:"starts with"},{Index:7,Name:"does not start with"},{Index:8,Name:"ends with"},{Index:9,Name:"does not end with"},{Index:10,Name:"contains"},{Index:11,Name:"does not contain"},{Index:12,Name:"=rgx="},{Index:13,Name:"!=rgx="},{Index:14,Name:"in"},{Index:15,Name:"not in"}],colorIndex=-1,filterIndex=-1,FILTER_VERSION="1.1.0.0",Filter=function(){this.Link=0;this.GroupNext=!1;this.Order=-1;this.Test=0;this.ActingOn="";this.Value="";this.SortingId=-1;this.UId=""},Link=function(){this.None=0;this.And=1;this.Or=2},LinkString=["None","And","Or"],Test=function(){this.Equal=0;this.GreaterThan=1;this.GreaterThanOrEqual=2;this.LessThan=3;this.LessThanOrEqual=4;this.NotEqual=5;this.StartsWith=6;this.NotStartsWith=7;this.EndsWith=8;this.NotEndsWith=9;this.Contains=10;this.DoesNotContain=11;this.RegexMatch=12;this.RegexNotMatch=13;this.In=14;this.NotIn=15},TestString=["Equal","GreaterThan","GreaterThanOrEqual","LessThan","LessThanOrEqual","NotEqual","StartsWith","NotStartsWith","EndsWith","NotEndsWith","Contains","DoesNotContain","RegexMatch","RegexNotMatch","In","NotIn"],Filter=function(){this.SortingId=-1;this.UId="";this.ReportKey="";this.SingleFormReportKey="";this.Link=0;this.Test=0;this.ActingOn="";this.Value="";this.Order=1;this.GroupNext=!1},emptyGuid="00000000-0000-0000-0000-000000000000";