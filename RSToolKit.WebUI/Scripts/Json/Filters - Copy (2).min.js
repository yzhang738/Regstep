function Filter(n,t,i){var e;typeof t=="undefined"&&(t=null);e=!1;typeof i=="boolean"&&(e=i);var u=-1,f=-1,r=this;if(this.Table=n,this.Modal=null,e||(this.Modal=FILTER_GenerateModal(t)),this.GenerateActing=function(n){var i,t;for(typeof n=="undefined"&&(n=""),i='<select class="filter-actingon form-control"><option>Make a Selection<\/option>',t=0;t<this.Table.Headers.length;t++)i+='<option value="'+this.Table.Headers[t].Id+'"'+(this.Table.Headers[t].Id===n?' selected="selected"':"")+">"+this.Table.Headers[t].Label+"<\/option>";return i+"<\/select>"},this.Generate=function(){var t,f,n,i,e;if(this.Modal!==null){for(this.Modal.find(".table-filter-body").html(""),u=-1,t="",f=0;f<this.Table.Filters.length;f++)u++,n=this.Table.Filters[f],i=FindHeader(this.Table,n.ActingOn),t='<tr class="filter" data-index="'+u+'"><td><input type="hidden" class="filter-groupNext-value" />',t+='<input type="checkbox" class="filter-groupNext" /> <a href="#" class="filter-delete"><span class="glyphicon glyphicon-trash"><\/span><\/a>',t+="<\/td>",t+="<td>",f===0?t+='<input type="hidden" class="filter-link" value="none" />':(t+='<select class="filter-link form-control">',t+='<option value="and"'+(n.Link==="and"?' selected="selected"':"")+">And<\/option>",t+='<option value="or"'+(n.Link==="or"?' selected="selected"':"")+">Or<\/option>",t+="<\/select>"),t+="<\/td>",t+="<td>",t+=this.GenerateActing(n.ActingOn),t+="<\/td>",t+="<\/td>",t+="<td>",t+='<select class="filter-test form-control">',t+="<\/select>",t+="<\/td>",t+="<td>",t+=this.GenerateValueInput(i,n.Value),t+="<\/td>",t+="<\/tr>",this.Modal.find(".table-filter-body").append(t),e="",e=i.Type==="itemParent"?'<option value="=="'+(n.Test==="=="?' selected="selected"':"")+'>Equals<\/option><option value="!="'+(n.Test==="!="?' selected="selected"':"")+">Not Equals<\/option>":i.Type==="multipleSelection"?'<option value="=="'+(n.Test==="=="?' selected="selected"':"")+'>Equals<\/option><option value="!="'+(n.Test==="!="?' selected="selected"':"")+'>Not Equals<\/option><option value="in"'+(n.Test==="in"?' selected="selected"':"")+'>In<\/option><option value="notin"'+(n.Test==="notin"?' selected="selected"':"")+">Not In<\/option>":i.Type==="number"||i.Type.indexOf("rating")===0?'<option value="=="'+(n.Test==="=="?' selected="selected"':"")+'>Equals<\/option><option value="!="'+(n.Test==="!="?' selected="selected"':"")+'>Not Equals<\/option><option value=">"'+(n.Test===">"?' selected="selected"':"")+'>Greater Than<\/option><option value=">="'+(n.Test===">="?' selected="selected"':"")+'>Greater Than or Equal<\/option><option value="<"'+(n.Test==="<"?' selected="selected"':"")+'>Less Than<\/option><option value="<="'+(n.Test==="<="?' selected="selected"':"")+">Less Than or Equal<\/option>":i.Type==="date"?'<option value="=="'+(n.Test==="=="?' selected="selected"':"")+'>Equals<\/option><option value="!="'+(n.Test==="!="?' selected="selected"':"")+'>Not Equals<\/option><option value=">"'+(n.Test===">"?' selected="selected"':"")+'>Greater Than<\/option><option value=">="'+(n.Test===">="?' selected="selected"':"")+'>Greater Than or Equal<\/option><option value="<"'+(n.Test==="<"?' selected="selected"':"")+'>Less Than<\/option><option value="<="'+(n.Test==="<="?' selected="selected"':"")+">Less Than or Equal<\/option>":'<option value="=="'+(n.Test==="=="?' selected="selected"':"")+'>Equals<\/option><option value="!="'+(n.Test==="!="?' selected="selected"':"")+'>Not Equals<\/option><option value="^="'+(n.Test==="^="?' selected="selected"':"")+'>Starts With<\/option><option value="!^="'+(n.Test==="!^="?' selected="selected"':"")+'>Does Not Start With<\/option><option value="$="'+(n.Test==="$="?' selected="selected"':"")+'>Ends With<\/option><option value="!$="'+(n.Test==="!$="?' selected="selected"':"")+'>Does Not End With<\/option><option value="=rgx="'+(n.Test==="=rgx="?' selected="selected"':"")+'>Regex Match<\/option><option value="!=rgx="'+(n.Test==="!=rgx="?' selected="selected"':"")+'>Regex Mismatch<\/option><option value="*="'+(n.Test==="*="?' selected="selected"':"")+'>Contains<\/option><option value="!*="'+(n.Test==="!*="?' selected="selected"':"")+'>Does Not Contain<\/option><option value=">"'+(n.Test===">"?' selected="selected"':"")+'>Greater Than<\/option><option value=">="'+(n.Test===">="?' selected="selected"':"")+'>Greater Than or Equal<\/option><option value="<"'+(n.Test==="<"?' selected="selected"':"")+'>Less Than<\/option><option value="<="'+(n.Test==="<="?' selected="selected"':"")+">Less Than or Equal<\/option>",$('tr[data-index="'+u+'"] .filter-test').html(e);this.Modal.find(".filter-actingon").on("change",function(){var n=$(this).closest("tr"),t=parseInt(n.attr("data-index"));r.ActingOnChange(n)});this.Modal.find(".filter-delete").on("click",function(n){r.DeleteStatement($(this).closest("tr"),n)})}},this.DeleteStatement=function(n,t){(t.preventDefault(),this.Modal!==null)&&(n.remove(),this.Modal.find(".filter").css("background-color","inherit"),this.Modal.find(".filter").find('input[name$="GroupNext"]').val("false"),f=-1,this.Modal.find("tr.filter").each(function(n){u=n;$(this).find("input").each(function(){var n=$(this).attr("name");typeof n!="undefined"&&(n=n.replace(/\[\d+\]/,"["+u+"]"),$(this).attr("name",n))});$(this).find('input[name$="Order"]').val(u+1)}),u--)},this.AddStatement=function(){if(this.Modal!==null){u++;var t=new JTableFilter,i=FindHeader(this.Table,t.ActingOn),n='<tr class="filter" data-index="'+u+'"><td><input type="hidden" class="filter-groupNext-value" />';n+='<input type="checkbox" class="filter-groupNext" /> <a href="#" class="filter-delete"><span class="glyphicon glyphicon-trash"><\/span><\/a>';n+="<\/td>";n+="<td>";this.Modal.find(".filter").length===0?n+='<input type="hidden" class="filter-link" value="none" />':(n+='<select class="filter-link form-control">',n+='<option value="and">And<\/option>',n+='<option value="or">Or<\/option>',n+="<\/select>");n+="<\/td>";n+="<td>";n+=this.GenerateActing();n+="<\/td>";n+="<\/td>";n+="<td>";n+='<select class="filter-test form-control">';n+="<\/select>";n+="<\/td>";n+="<td>";n+=this.GenerateValueInput(i);n+="<\/td>";n+="<\/tr>";this.Modal.find(".table-filter-body").append(n);this.Modal.find('.filter[data-index="'+u+'"]').find(".filter-actingon").on("change",function(){var n=$(this).closest("tr"),t=parseInt(n.attr("data-index"));r.ActingOnChange(n)});this.Modal.find('.filter[data-index="'+u+'"]').find(".filter-delete").on("click",function(n){var t=$(this).closest("tr");r.DeleteStatement(t,n)})}},this.Group=function(n){var r;if(n.preventDefault(),this.Modal!==null){if(r=this.Modal.find(".filter-groupNext:checked").length,r>1)f++;else return;f>=FILTER_colors.length&&(f=0);var u=!1,e=!1,t=null,o=0,i=[];this.Modal.find(".filter-groupNext").each(function(){if(u&&($(this).is(":checked")||(e=!0)),$(this).is(":checked")&&!e){var n=$(this).closest("tr");o++;u=!0;t=n.find(".filter-groupNext");t.val("true");n.css("background-color",FILTER_colors[f]);i.push(n)}});o==1&&(i[0].css("background-color","inherit"),i[0].find(".filter-groupNext-value").val("false"));t.val("false");this.Modal.find(".filter-groupNext").prop("checked",!1)}},this.Ungroup=function(n){(n.preventDefault(),this.Modal!==null)&&(this.Modal.find(".filter").css("background-color","inherit"),this.Modal.find(".filter").find(".filter-groupNext-value").val("false"),f=-1)},this.ActingOnChange=function(n){var i;try{n.find(".rating").rating("destroy")}catch(f){}var r=n.find(".filter-value"),t=FindHeader(this.Table,n.find(".filter-actingon").val()),u=this.GenerateValueInput(t);r.replaceWith(u);i="";i=t.Type==="itemParent"||t.Type==="boolean"?'<option value="==">Equals<\/option><option value="!=">Not Equals<\/option>':t.Type==="multipleSelection"?'<option value="==">Equals<\/option><option value="!=">Not Equals<\/option><option value="in">In<\/option><option value="notin">Not In<\/option>':t.Type==="number"||t.Type.indexOf("rating")===0?'<option value="==">Equals<\/option><option value="!=">Not Equals<\/option><option value=">">Greater Than<\/option><option value=">=">Greater Than or Equal<\/option><option value="<">Less Than<\/option><option value="<=">Less Than or Equal<\/option>':t.Type==="date"?'<option value="==">Equals<\/option><option value="!=">Not Equals<\/option><option value=">">Greater Than<\/option><option value=">=">Greater Than or Equal<\/option><option value="<">Less Than<\/option><option value="<=">Less Than or Equal<\/option>':'<option value="==">Equals<\/option><option value="!=">Not Equals<\/option><option value="^=">Starts With<\/option><option value="!^=">Does Not Start With<\/option><option value="$=">Ends With<\/option><option value="!$=">Does Not End With<\/option><option value="=rgx=">Regex Match<\/option><option value="!=rgx=">Regex Mismatch<\/option><option value="*=">Contains<\/option><option value="!*=">Does Not Contain<\/option><option value=">">Greater Than<\/option><option value=">=">Greater Than or Equal<\/option><option value="<">Less Than<\/option><option value="<=">Less Than or Equal<\/option>';n.find(".filter-test").html(i);try{n.find(".rating").rating()}catch(f){}try{n.find(".datetimepicker").datetimepicker()}catch(f){}},this.GenerateValueInput=function(n,t){var i,r,u,f;if(typeof t=="undefined"&&(t=""),i="",n===null)return'<span class="filter-value">Make a Selection<\/span>';if(n.Type==="itemParent"||n.Type==="multipleSelection"||n.Type==="boolean"){for(i+='<select class="filter-value form-control">',r=0;r<n.PossibleValues.length;r++)i+='<option value="'+n.PossibleValues[r].Id+'"'+(n.PossibleValues[r].Id===t?' selected="true"':"")+">"+n.PossibleValues[r].Label+"<\/option>";i+="<\/select>"}else n.Type.indexOf("rating")===0?(t===""&&(t="0"),u=n.Type,u=u.split("=>")[1],f=JSON.parse(u),i+='<input class="filter-value form-control rating" min="'+f.min+'" max="'+f.max+'" data-step="'+f.step+'" type="number" value="'+t+'" />'):i+='<input class="filter-value form-control'+(n.Type==="date"?" datetimepicker":"")+'" value="'+t+'" />';return i},this.Modal!==null){this.Modal.find(".set-filters").on("click",function(){r.Modal.modal("hide");r.Table.Filters=[];r.Modal.find(".filter").each(function(n){var i=$(this),t=new JTableFilter;t.GroupNext=i.find(".filter-groupNext-value").val().toLowerCase()==="true";t.ActingOn=i.find(".filter-actingon").val();t.Link=i.find(".filter-link").val();t.Order=n;t.Test=i.find(".filter-test").val();t.Value=i.find(".filter-value").val();r.Table.Filters.push(t)});r.Table.Filtered=!1;r.Table.GetPage()});this.Modal.find(".add-filter").on("click",function(n){n.preventDefault();r.AddStatement()});this.Modal.find(".ungroup").on("click",function(n){r.Ungroup(n)});this.Modal.find(".group").on("click",function(n){r.Group(n)})}}function FILTER_GenerateModal(n){var i,t;return(n===null&&(n="m_filter"+ ++FILTER_modalIndex),n.legth>0&&n[0]==="#"&&(n=n.substr(1,n.length)),i=$(n),i.length>0)?i:(t='<div class="modal fade" id="'+n+'"><div class="modal-dialog modal-lg"><div class="modal-header"><h3 class="modal-title">Filters<\/h3><\/div>',t+='<div class="modal-body"><div class="add-padding-top text-color-1"><h4>Current Filters<\/h4><\/div>',t+='<div class="row color-grey-2 add-padding-vertical-5"><div class="col-sm-6"><div class="add-padding-vertical-5"><a href="#" class="group"><span class="glyphicon glyphicon-link"><\/span> Group Selected<\/a><\/div><\/div>',t+='<div class="col-sm-6"><div class="add-padding-vertical-5"><a href="#" class="ungroup"><span class="glyphicon glyphicon-link"><\/span> Ungroup All<\/a><\/div><\/div><\/div>',t+='<div class="row"><table class="table table-filter">',t+="<thead><tr><th><\/th><th>Link<\/th><th>Variable<\/th><th>Test<\/th><th>Value<\/th><\/tr><\/thead>",t+='<tbody class="table-filter-body"><\/tbody><tfoot><tr><td colspan="5"><a href="#" class="add-filter"><span class="glyphicon glyphicon-small glyphicon-plus"><\/span> New Statement<\/a><\/td><\/tr><\/tbody>',t+='<\/table><\/div><\/div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Cancel<\/button><button type="button" class="btn btn-default set-filters">Apply Filters<\/button>',t+="<\/div><\/div><\/div>",$("body").append(t),$("#"+n))}var FILTER_colors=["#FFFFB0","#B0B0FF","#68C473","#C468B9","#6669BA","#BAB766"],FILTER_modalIndex=-1,FILTER_VERSION="1.1.1.0";
//# sourceMappingURL=Filters.min.js.map
