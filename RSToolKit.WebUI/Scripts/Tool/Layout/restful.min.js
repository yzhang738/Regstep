function addAntiForgeryToken(n){var t="";return typeof jsonAntiForgeryToken=="undefined"&&(t=toolkit.jsonAntiForgeryToken),EXT.getName(n)==="FormData"?n.append("__RequestVerificationToken",t):n.__RequestVerificationToken=t,n}function AddJsonAntiForgeryToken(n){var t="";return typeof jsonAntiForgeryToken=="undefined"&&(t=toolkit.jsonAntiForgeryToken),EXT.getName(n)==="FormData"?n.append("__RequestVerificationToken",t):n.__RequestVerificationToken=t,n}var RESTFUL=function(n){var i={SHOWMESSAGE:'<div class="modal fade restful-showmessage" data-backdrop="static" data-keyboard="false"><div class="modal-dialog"><div class="modal-header"><h3 class="restful-showmessage-title"><\/h3><\/div><div class="modal-body"><div class="row restful-showmessage-body"><\/div><\/div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">OK<\/button><\/div><\/div><\/div>',CONFIRMMESSAGE:'<div class="modal fade restful-showmessage" data-backdrop="static" data-keyboard="false"><div class="modal-dialog"><div class="modal-header"><h3 class="restful-showmessage-title"><\/h3><\/div><div class="modal-body"><div class="row restful-showmessage-body"><\/div><\/div><div class="modal-footer"><button type="button" class="btn btn-default no-btn"><\/button><button type="button" class="btn btn-default yes-btn"><\/button><\/div><\/div><\/div>'},t={INHERIT:"inherit",REFRESH:"refresh",NOTHING:"nothing",CUSTOM:"custom",SHOWMESSAGE:"showmessage"};return n.xhrError=function(n,t){typeof t=="undefined"&&(t="Unhandled server error.");prettyProcessing.hidePleaseWait();alert(t)},n.parse=function(n){return/^application\/json/i.test(n.getResponseHeader("content-type"))?JSON.parse(n.responseText):/^application\/xml/i.test(n.getResponseHeader("content-type"))?XMLSerializer.parse(n.responseText):void 0},n.jsonHeader=function(n){n.setRequestHeader("Content-Type","application/json")},n.ajaxHeader=function(n){n.setRequestHeader("X-Requested-With","XMLHttpRequest")},n.showError=function(n,t){prettyProcessing.hidePleaseWait();n=n||"An unhandled server error occured.";t=t||"Server Error";var r=$(i.SHOWMESSAGE);$("body").append(r);r.find(".restful-showmessage-title").html(t);r.find(".restful-showmessage-body").html(n);r.on("hidden.bs.modal",function(){r.remove()});r.modal("show")},n.showConfirmation=function(n,t,r,u,f,e){prettyProcessing.hidePleaseWait();n=n||"Do you wish to continue?";t=t||"Continue";f=f||"Yes";e=e||"No";var o=$(i.CONFIRMMESSAGE);$("body").append(o);o.find(".restful-showmessage-title").html(t);o.find(".restful-showmessage-body").html(n);o.find(".yes-btn").text(f).on("click",function(n){n.preventDefault();o.modal("hide");r()});o.find(".no-btn").text(e).on("click",function(n){n.preventDefault();o.modal("hide");u()});o.on("hidden.bs.modal",function(){o.remove()});o.modal("show")},n.bind=function(n){$(n).on("click",function(n){RESTFUL._click(n,$(this))})},n._click=function(i,r){var l,a,e,y,s,v,u,f;i.preventDefault();typeof n._updateCKEDITOR!="undefined"&&n._updateCKEDITOR();l=r.closest(".modal");a=r.attr("data-xhr-modalkeep");t_modalKeep=!1;typeof a!="undefined"&&(t_modalKeep=a==="true");l.length===0||t_modalKeep||l.modal("hide");e=r.attr("data-xhr-method");typeof e=="undefined"&&(e="get");e=e.toLowerCase();y=r.attr("href");s={};typeof r.attr("data-xhr-options")!="undefined"&&(s=JSON.parse(r.attr("data-xhr-options")));var h=r.attr("data-xhr-oncomplete"),c=r.attr("data-xhr-confirm"),o=r.attr("data-xhr-failmessage");if(typeof o!="undefined"&&o!==null&&o||(o="Unhandled Server Error"),toolkit.addJsonAntiForgeryToken(s),v=!1,(typeof c!="undefined"||e==="delete")&&(v=!0),!v||(typeof c=="undefined"&&(c="Are you sure you want to delete. This cannot be undone."),confirm(c))){prettyProcessing.showPleaseWait();u=t.INHERIT;typeof h=="undefined"&&(h="inherit");switch(h.toLowerCase()){case t.REFRESH:u=t.REFRESH;break;case t.NOTHING:u=t.NOTHING;break;case t.INHERIT:u=t.INHERIT;break;case t.SHOWMESSAGE:u=t.SHOWMESSAGE;break;default:u=t.CUSTOM}f=new XMLHttpRequest;f.open(e,y,!0);n.ajaxHeader(f);f.setRequestHeader("Content-Type","application/json");f.onload=function(i){var r,f;if(this.status===200)if(r=n.parse(this),r.Success){(typeof r.Location=="undefined"||r.Location===null||r.Location==="")&&(r.Location="");u===t.INHERIT&&(r.Location===t.SHOWMESSAGE?u=t.SHOWMESSAGE:r.Location===t.REFRESH?u=t.REFRESH:r.Location===t.NOTHING&&(u=t.NOTHING));switch(u){case t.INHERIT:r.Location!==""&&(window.location.href=r.Location);break;case t.SHOWMESSAGE:RESTFUL.showError(r.SuccessMessage,r.SuccessMessageTitle);break;case t.REFRESH:window.location.reload();break;case t.CUSTOM:window.location.href=h}prettyProcessing.hidePleaseWait()}else prettyProcessing.hidePleaseWait(),f=r.Message,RESTFUL.showError(f,"Error Message");else i.currentTarget.status===400?RESTFUL.showError(i.currentTarget.responseBody,"Bad Request"):(prettyProcessing.hidePleaseWait(),RESTFUL.showError(o,"Error Message"))};f.onerror=function(){prettyProcessing.hidePleaseWait();RESTFUL.showError(o,"Error Message")};f.send(JSON.stringify(s));f=null;s=null}},n._updateCKEDITOR=function(){if(typeof CKEDITOR!="undefined")for(var n in CKEDITOR.instances)CKEDITOR.instances[n].updateElement()},$(document).ready(function(){$("a[data-xhr-method]").on("click",function(t){n._click(t,$(this))});$("form[data-xhr-method]").on("submit",function(i){var c,u,a,r,l,v,h,f;if(i.preventDefault(),c=$(this).triggerHandler("form.validate"),c=typeof c=="undefined"?!0:c.trim().toLowerCase()==="true",c){typeof n._updateCKEDITOR!="undefined"&&n._updateCKEDITOR();u=$(this);a=u.closest(".modal");a.length!==0&&a.modal("hide");prettyProcessing.showPleaseWait();r=u.attr("data-xhr-method");typeof r!="undefined"&&r!==null&&r||(r=u.attr("method"),typeof r!="undefined"&&r!==null&&r||(r="post"));r=r.toLowerCase();var y=u.attr("action"),e=u.attr("data-xhr-oncomplete"),o=u.attr("data-xhr-confirm"),s=u.attr("data-xhr-failmessage");if(typeof s!="undefined"&&s!==null&&s||(s="Unhandled Server Error"),l=new FormData(u[0]),toolkit.addJsonAntiForgeryToken(l),v=!1,(typeof o!="undefined"||r==="delete")&&(v=!0),!v||(typeof o!="undefined"&&o!==null&&o||(o="Are you sure you want to delete. This cannot be undone."),confirm(o))){h=t.INHERIT;typeof e!="undefined"&&e!==null&&e||(e="inherit");switch(e.toLowerCase()){case t.REFRESH:h=t.REFRESH;break;case t.NOTHING:h=t.NOTHING;break;case t.INHERIT:h=t.INHERIT;break;default:h=t.CUSTOM}f=new XMLHttpRequest;f.open(r,y,!0);n.ajaxHeader(f);f.onload=function(){var i,f,r;if(this.status===200)if(i=n.parse(this),i.Success){(typeof i.Location=="undefined"||i.Location===null||i.Location==="")&&(i.Location="");switch(h){case t.INHERIT:switch(i.Location.toLowerCase()){case t.REFRESH:window.location.reload();break;case t.NOTHING:break;default:i.Location!==""&&(window.location.href=i.Location)}break;case t.REFRESH:window.location.reload();break;case t.CUSTOM:window.location.href=e}prettyProcessing.hidePleaseWait()}else prettyProcessing.hidePleaseWait(),f=i.Message,alert(f);else prettyProcessing.hidePleaseWait(),alert(s);r=u.attr("data-xhr-clearform");typeof r!="undefined"&&r&&(u.find("input").each(function(){var t=$(this),n=t.attr("type");(typeof n=="undefined"||n!=="hidden")&&$(this).val("")}),u.find("select").val(""))};f.onerror=function(){prettyProcessing.hidePleaseWait();alert(s)};f.send(l);f=null;l=null}}})}),n}(RESTFUL||{},toolkit),RESTUFL_VERSION="unknown";
//# sourceMappingURL=restful.min.js.map
