function AddJsonAntiForgeryToken(n){var t="";return typeof jsonAntiForgeryToken=="undefined"&&(t=toolkit.jsonAntiForgeryToken),EXT.getName(n)==="FormData"?n.append("__RequestVerificationToken",t):n.__RequestVerificationToken=t,n}var RESTUFL_VERSION="unknown",RESTFUL={xhrError:function(n,t){typeof t=="undefined"&&(t="Unhandled server error.");prettyProcessing.hidePleaseWait();alert(t)},parse:function(n){return/^application\/json/i.test(n.getResponseHeader("content-type"))?JSON.parse(n.responseText):/^application\/xml/i.test(n.getResponseHeader("content-type"))?XMLSerializer.parse(n.responseText):void 0},jsonHeader:function(n){n.setRequestHeader("Content-Type","application/json")},ajaxHeader:function(n){n.setRequestHeader("X-Requested-With","XMLHttpRequest")},showError:function(n,t){prettyProcessing.hidePleaseWait();n=n||"An unhandled server error occured.";t=t||"Server Error";var i=$(restful_html_object.SHOWMESSAGE);$("body").append(i);i.find(".restful-showmessage-title").html(t);i.find(".restful-showmessage-body").html(n);i.on("hidden.bs.modal",function(){i.remove()});i.modal("show")},showConfirmation:function(n,t,i,r,u,f){prettyProcessing.hidePleaseWait();n=n||"Do you wish to continue?";t=t||"Continue";u=u||"Yes";f=f||"No";var e=$(restful_html_object.CONFIRMMESSAGE);$("body").append(e);e.find(".restful-showmessage-title").html(t);e.find(".restful-showmessage-body").html(n);e.find(".yes-btn").text(u).on("click",function(n){return n.preventDefault(),e.modal("hide"),!0});e.find(".no-btn").text(f).on("click",function(n){return n.preventDefault(),e.modal("hide"),!0});e.on("hidden.bs.modal",function(){e.remove()});e.modal("show")},bind:function(n){$(n).on("click",function(n){RESTFUL.Click(n,$(this))})}},restful_html_object={},redirect;restful_html_object.SHOWMESSAGE='<div class="modal fade restful-showmessage" data-backdrop="static" data-keyboard="false"><div class="modal-dialog"><div class="modal-header"><h3 class="restful-showmessage-title"><\/h3><\/div><div class="modal-body"><div class="row restful-showmessage-body"><\/div><\/div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">OK<\/button><\/div><\/div><\/div>';restful_html_object.CONFIRMMESSAGE='<div class="modal fade restful-showmessage" data-backdrop="static" data-keyboard="false"><div class="modal-dialog"><div class="modal-header"><h3 class="restful-showmessage-title"><\/h3><\/div><div class="modal-body"><div class="row restful-showmessage-body"><\/div><\/div><div class="modal-footer"><button type="button" class="btn btn-default no-btn"><\/button><button type="button" class="btn btn-default yes-btn"><\/button><\/div><\/div><\/div>';$(document).ready(function(){function n(){if(typeof CKEDITOR!="undefined")for(var n in CKEDITOR.instances)CKEDITOR.instances[n].updateElement()}if(RESTFUL_VERSION="1.2.1.1",typeof jQuery=="undefined")throw"jQuery is required for restful.js";if(typeof prettyProcessing=="undefined")throw"prettyProcessing is requred for restful.js";$("a[data-xhr-method]").on("click",function(n){RESTFUL.Click(n,$(this))});$("form[data-xhr-method]").on("submit",function(t){var h,r,c,i,l,a,o,s;if(t.preventDefault(),h=$(this).triggerHandler("form.validate"),h=typeof h=="undefined"?!0:h.trim().toLowerCase()==="true",h){typeof n!="undefined"&&n();r=$(this);c=r.closest(".modal");c.length!==0&&c.modal("hide");prettyProcessing.showPleaseWait();i=r.attr("data-xhr-method");typeof i!="undefined"&&i!==null&&i||(i=r.attr("method"),typeof i!="undefined"&&i!==null&&i||(i="post"));i=i.toLowerCase();var v=r.attr("action"),u=r.attr("data-xhr-oncomplete"),f=r.attr("data-xhr-confirm"),e=r.attr("data-xhr-failmessage");if(typeof e!="undefined"&&e!==null&&e||(e="Unhandled Server Error"),l=new FormData(r[0]),AddJsonAntiForgeryToken(l),a=!1,(typeof f!="undefined"||i==="delete")&&(a=!0),!a||(typeof f!="undefined"&&f!==null&&f||(f="Are you sure you want to delete. This cannot be undone."),confirm(f))){o=redirect.INHERIT;typeof u!="undefined"&&u!==null&&u||(u="inherit");switch(u.toLowerCase()){case redirect.REFRESH:o=redirect.REFRESH;break;case redirect.NOTHING:o=redirect.NOTHING;break;case redirect.INHERIT:o=redirect.INHERIT;break;default:o=redirect.CUSTOM}s=new XMLHttpRequest;s.open(i,v,!0);RESTFUL.ajaxHeader(s);s.onload=function(n){var s=n.currentTarget,t,f,i;if(n.currentTarget.status===200)if(t=JSON.parse(s.responseText),t.Success){(typeof t.Location=="undefined"||t.Location===null||t.Location==="")&&(t.Location="");switch(o){case redirect.INHERIT:switch(t.Location.toLowerCase()){case redirect.REFRESH:window.location.reload();break;case redirect.NOTHING:break;default:t.Location!==""&&(window.location.href=t.Location)}break;case redirect.REFRESH:window.location.reload();break;case redirect.CUSTOM:window.location.href=u}prettyProcessing.showPleaseWait()}else prettyProcessing.hidePleaseWait(),f=t.Message,alert(f);else prettyProcessing.hidePleaseWait(),alert(e);i=r.attr("data-xhr-clearform");typeof i!="undefined"&&i&&(r.find("input").each(function(){var t=$(this),n=t.attr("type");(typeof n=="undefined"||n!=="hidden")&&$(this).val("")}),r.find("select").val(""))};s.onerror=function(){prettyProcessing.hidePleaseWait();alert(e)};s.send(l)}}})});redirect={};redirect.INHERIT="inherit";redirect.REFRESH="refresh";redirect.NOTHING="nothing";redirect.CUSTOM="custom";redirect.SHOWMESSAGE="showmessage";RESTFUL.Click=function(n,t){var h,c,r,a,e,l,i,u;n.preventDefault();typeof UpdateCKEDITOR!="undefined"&&UpdateCKEDITOR();h=t.closest(".modal");c=t.attr("data-xhr-modalkeep");t_modalKeep=!1;typeof c!="undefined"&&(t_modalKeep=c==="true");h.length===0||t_modalKeep||h.modal("hide");r=t.attr("data-xhr-method");typeof r=="undefined"&&(r="get");r=r.toLowerCase();a=t.attr("href");e={};typeof t.attr("data-xhr-options")!="undefined"&&(e=JSON.parse(t.attr("data-xhr-options")));var o=t.attr("data-xhr-oncomplete"),s=t.attr("data-xhr-confirm"),f=t.attr("data-xhr-failmessage");if(typeof f!="undefined"&&f!==null&&f||(f="Unhandled Server Error"),AddJsonAntiForgeryToken(e),l=!1,(typeof s!="undefined"||r==="delete")&&(l=!0),!l||(typeof s=="undefined"&&(s="Are you sure you want to delete. This cannot be undone."),confirm(s))){prettyProcessing.showPleaseWait();i=redirect.INHERIT;typeof o=="undefined"&&(o="inherit");switch(o.toLowerCase()){case redirect.REFRESH:i=redirect.REFRESH;break;case redirect.NOTHING:i=redirect.NOTHING;break;case redirect.INHERIT:i=redirect.INHERIT;break;case redirect.SHOWMESSAGE:i=redirect.SHOWMESSAGE;break;default:i=redirect.CUSTOM}u=new XMLHttpRequest;u.open(r,a,!0);RESTFUL.ajaxHeader(u);u.setRequestHeader("Content-Type","application/json");u.onload=function(n){var u=n.currentTarget,t,r;if(n.currentTarget.status===200)if(t=RESTFUL.parse(n.currentTarget),t.Success){(typeof t.Location=="undefined"||t.Location===null||t.Location==="")&&(t.Location="");i===redirect.INHERIT&&(t.Location===redirect.SHOWMESSAGE?i=redirect.SHOWMESSAGE:t.Location===redirect.REFRESH?i=redirect.REFRESH:t.Location===redirect.NOTHING&&(i=redirect.NOTHING));switch(i){case redirect.INHERIT:t.Location!==""&&(window.location.href=t.Location);break;case redirect.SHOWMESSAGE:RESTFUL.showError(t.SuccessMessage,t.SuccessMessageTitle);break;case redirect.REFRESH:window.location.reload();break;case redirect.CUSTOM:window.location.href=o}prettyProcessing.hidePleaseWait()}else prettyProcessing.hidePleaseWait(),r=t.Message,RESTFUL.showError(r,"Error Message");else n.currentTarget.status===400?RESTFUL.showError(n.currentTarget.responseBody,"Bad Request"):(prettyProcessing.hidePleaseWait(),RESTFUL.showError(f,"Error Message"))};u.onerror=function(){prettyProcessing.hidePleaseWait();RESTFUL.showError(f,"Error Message")};u.send(JSON.stringify(e))}};
//# sourceMappingURL=restful.min.js.map
