function GetData(){processing.showPleaseWait();report.Registrants=[];$.ajax({url:"../../Cloud/SingleFormReportData/"+report.Id+"/"+report.Paging.Page+"/"+report.Paging.RecordsPerPage,type:"get",contentType:"application/json",dataType:"json",success:function(n){var t,u,e,i;if(n.Success){for($.extend(report,n.Data),$("#registrantData").html(""),t={},t.header={},t.data={},t.pageNumber={},t.header.html="",t.header.tr=$("#headers tr"),t.data.tbody=$("#registrantData"),t.data.html="",t.pageNumber.input=$("#pageNumer"),i=0;i<report.Headers.length;i++)t.header.html+="<th>"+report.Headers[i].Label+"<\/th>";for(t.header.tr.html(t.header.html),i=0;i<report.Rows.length;i++){for(t.data.html+='<tr id="'+report.Rows[i].Id+'"">',u=0;u<report.Headers.length;u++){var f=findData(report.Rows[i].Columns,report.Headers[u].Id),o=" ",r=report.Headers[u].Id;r!="status"&&r!="audience"&&r!="confirmation"&&r!="dateregistered"&&r!="rsvp"&&r!="type"&&r!="email"&&r!=""&&(o+='class="editable-item cursor-pointer"');e="";f!==null&&(e=f.Id);t.data.html+="<td"+o+' data-id="'+e+'">';f!==null&&(t.data.html+=f.PRettyValue!==null?f.PrettyValue:"<i>No Value<\/i>");t.data.html+="<\/td>"}t.data.html+="<\/tr>"}for(t.data.tbody.html(t.data.html),$("#pageNumber").html(""),i=0;i<report.Paging.TotalPages;i++)$("#pageNumber").append('<option value="'+(i+1)+'"'+(i+1==report.Paging.Page?' selected="true"':"")+">"+(i+1)+"<\/option>");report.Paging.Page==report.Paging.TotalPages?$("#pageRight").addClass("disabled"):$("#pageRight").removeClass("disabled");report.Paging.Page==1?$("#pageLeft").addClass("disabled"):$("#pageLeft").removeClass("disabled");BindEditable();$("#totalRecords").html(report.Paging.TotalRecords)}else alert(n.Message);processing.hidePleaseWait()},error:function(){alert("Server Error");processing.hidePleaseWait()}})}function JsonTable(){this.Headers=[];this.Rows=[];this.Name="";this.Id="";this.Paging={Page:1,RecordsPerPage:25}}function ReportJson(){this.UId="";this.Page=1;this.PageSize=25;this.Success=!0;this.TotalPages=1;this.Headers=new DataObject;this.Data=[]}function DataObject(){this.Data=[];this.Id=""}function DataSet(){this.Header="";this.Value="";this.Id=""}function findData(n,t){for(var i=0;i<n.length;i++)if(n[i].HeaderId==t)return n[i];return null}function RunBinding(){$('input[data-component-type="datetime"]').datetimepicker({autoclose:!0});$('input[type="hidden"][data-component-type="checkboxgroup"]').each(function(){checkboxgroups[$(this).attr("id")]={parent:$(this),timeExclusion:$(this).parent().attr("data-component-timeexclusion")=="True",Items:[]};$(this).parent().find('input[type="checkbox"]').each(function(){var n=$(this).attr("data-parent");if(checkboxgroups[n].Items.push($(this)),checkboxgroups[n].timeExclusion)$(this).on("change",function(){for(var s,h,r,c,f,i=$(this).attr("data-parent"),e=[],u=[],t=[],o=!1,n=0;n<checkboxgroups[i].Items.length;n++)checkboxgroups[i].Items[n].prop("checked")&&(checkboxgroups[i].Items[n].val()!=$(this).val()&&u.push($(this)),e.push(checkboxgroups[i].Items[n].val()),t.push(checkboxgroups[i].Items[n]));for(n=0;n<t.length;n++)for(s=moment(t[n].attr("data-agenda-start")),h=moment(t[n].attr("data-agenda-end")),r=0;r<t.length;r++)t[n]!=t[r]&&(c=moment(t[r].attr("data-agenda-start")),f=moment(t[r].attr("data-agenda-end")),f.isAfter(s)&&f.isBefore(h)&&(o=!0));if(o){for(n=0;n<checkboxgroups[i].Items.length;n++)checkboxgroups[i].Items[n].prop("checked",!1);for(n=0;n<u.length;n++)u[n].prop("checked",!0);alert("Your selection has time conflictions")}else checkboxgroups[i].parent.val(JSON.stringify(e))});else $(this).on("change",function(){for(var n=$(this).attr("data-parent"),i=[],t=0;t<checkboxgroups[n].Items.length;t++)checkboxgroups[n].Items[t].prop("checked")&&i.push(checkboxgroups[n].Items[t].val());checkboxgroups[n].parent.val(JSON.stringify(i))})})});$('input[type="hidden"][data-component-type="radiogroup"]').each(function(){radiogroups[$(this).attr("id")]={parent:$(this),Items:[]};$(this).parent().find('input[type="radio"]').each(function(){var n=$(this).attr("data-parent");radiogroups[n].Items.push($(this));$(this).on("change",function(){var n=$(this).attr("data-parent");radiogroups[n].parent.val($(this).val())})})});$(".uploaded-image").each(function(){$.ajax({type:"Get",url:"../../Cloud/RegistrantImageThumbnail/"+$(this).attr("data-form-registrant")+"?component="+$(this).attr("data-form-component"),success:function(n){$(this).attr("src",n)}})})}function BindEditable(){$(".editable-item").on("click",function(){$("#editModal .modal-body").find("#editingProgress").show();$("#editModal .modal-body").find("#editingData").hide();$("#editModal").modal("show");oldData.id=$(this).attr("data-id");oldData.regKey=$(this).parent("tr").attr("id");oldData.value=$(this).html();$(this).hasClass("file")?setTimeout(function(){ShowEditableItem(oldData.id,oldData.regKey)},1e3):ShowEditableItem(oldData.id,oldData.regKey)})}function ShowEditableItem(n,t){var i=$("#editModal .modal-dialog").width()-62;$.ajax({url:"../../Cloud/EditComponent/"+n+"?registrantKey="+t+"&width="+i,type:"get",contentType:"application/json",dataType:"json",success:function(n){n.Success?($("#editModal").find("#editingData").html(n.Html).show("fast"),$("#editModal").find("#editingProgress").hide("fast"),RunBinding()):($("#editModal").modal("hide"),oldData.Id=null,oldData.regKey=null,alert(n.Message))},error:function(){processing.hidePleaseWait();oldData.Id=null;oldData.regKey=null;alert("Server Error")}})}var report=new JsonTable,oldData={id:null,regKey:null,value:null},checkboxgroups={},radiogroups={};$(document).ready(function(){report.Id=id;GetData();$("#pageSize").on("blur",function(){var n=$(this);isNaN(n.val())?(alert("You must provide a valid number."),n.val(report.Paging.RecordsPerPage)):report.Paging.RecordsPerPage=Math.round(n.val());GetData()});$(".table-sort").on("click",function(n){n.preventDefault();var t=$(this),i=t.attr("data-actingon");report.Sortings.ActingOn==i?(report.Sortings.Descending=!report.Sortings.Descending,t.children(".sort-icon").toggleClass("glyphicon-sort-by-attributes"),t.children(".sort-icon").toggleClass("glyphicon-sort-by-attributes-alt")):($(".sort-icon").removeClass("glyphicon-sort-by-attributes-alt").removeClass("glyphicon-sort-by-attributes"),report.Sortings.ActingOn=i,report.Sortings.Descending=!1,t.children(".sort-icon").addClass("glyphicon-sort-by-attributes"),t.children(".sort-icon").removeClass("glyphicon-sort-by-attributes-alt"));GetData()});$("#pageNumber").on("change",function(){report.Paging.Page=$(this).val();GetData()});$("#pageRight").on("click",function(){(report.Paging.Page++,$(this).hasClass("disabled"))||($("#pageNumber").val(report.Page),GetData())});$("#pageLeft").on("click",function(){(report.Paging.Page--,$(this).hasClass("disabled"))||($("#pageNumber").val(report.Page),GetData())});$("#formType").on("change",function(){GetData()});$("#saveEdit").on("click",function(){var f,i,r,e,u,t,o,n;for($("#editModal").find("#editingData").hide("fast"),$("#editModal").find("#editingProgress").show("fast"),f=[],i=0;$('input[name^="Waitlistings['+i+']"]').length>0;){for(r={},e=$('input[name^="Waitlistings['+i+']"]'),u=0;u<e.length;u++)t=$(e[u]),/Key$/i.test(t.attr("name"))?r.Key=t.val():t.attr("type")==="checkbox"&&(r.Value=t.prop("checked")?!0:!1);i++;f.push(r)}o={ComponentKey:oldData.id,RegistrantKey:oldData.regKey,Value:$("#"+oldData.id).val(),Waitlistings:f};AddJsonAntiForgeryToken(o);n=new XMLHttpRequest;n.open("put","../../Cloud/SaveRegistrantData",!0);RESTFUL.jsonHeader(n);n.onerror=function(n){RESTFUL.xhrError(n)};n.onload=function(n){var t,r,i;if(c_xhr=n.currentTarget,c_xhr.status===200)if(t=RESTFUL.parse(c_xhr),t.Success)$("#"+oldData.regKey).find('td[data-id="'+oldData.id+'"]').html(t.NewValue),$("#editModal").modal("hide");else{for($("#editModal .modal-body").find("#editingProgress").hide("fast"),$("#editModal .modal-body").find("#editingData").show("fast"),r="",i=0;i<t.Errors.length;i++)i!=0&&(r+="<br />"),r+=t.Errors[i];$("#editModal").find(".form-messagebox").html(r).show("fast")}else $("#editModal").modal("hide"),RESTFUL.showError("Unhandled Server Error")};n.send(JSON.stringify(o))})});
//# sourceMappingURL=ViewSingleFormReport.min.js.map
