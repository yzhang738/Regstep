var CONTACTLIST={};CONTACTLIST.VERSION="3.0.0.1";CONTACTLIST.EditingData=function(){this.row=null;this.column=null;this.header=null};CONTACTLIST.EditingHeader=function(){this.header="";this.name="";this.descriminator=6;this.descriminatorOptions={}};$(document).on("ready",function(){function r(n){(typeof n=="undefined"||n===null)&&(n=!1);$("#m_save_files").html("Loading Files");prettyProcessing.showPleaseWait("Retrieving Report","Please Wait");var t=new XMLHttpRequest;t.open("get",window.location.origin+"/Cloud2/EmailLists");RESTFUL.ajaxHeader(t);t.onerror=function(n){prettyProcessing.hidePleaseWait();RESTFUL.xhrError(n)};t.onload=function(t){var i,f,r,e;if(c_xhr=t.currentTarget,c_xhr.status===200)if(i=RESTFUL.parse(c_xhr),i.Success){for(prettyProcessing.hidePleaseWait(),f=$("#m_save_files"),f.html(""),r=0;r<i.Files.length;r++)e=i.Files[r],f.append('<div class="report-file" data-id="'+e.Id+'">'+e.Name+"<\/div>");if(n){$(".report-file").on("click",function(){u($(this).attr("data-id"));$("m_save").modal("hide")});$("#m_save_fileInput").parent().hide()}else{$(".report-file").on("click",function(){$("#m_save_fileInputId").val($(this).attr("data-id"));$("#m_save_fileInput").val($(this).html())});$("#m_save_fileInput").parent().show()}$("#m_save").modal("show")}else prettyProcessing.hidePleaseWait(),RESTFUL.showError();else prettyProcessing.hidePleaseWait(),RESTFUL.showError()};t.send()}function u(t){$("#m_save").modal("hide");n.Load(window.location.origin+"/Cloud2/Contacts",{id:t});$("#id_action option").prop("selected",!1);$('#id_action option[value="'+t+'"]').prop("selected",!0);$("#headerSavedList option").prop("selected",!1);$('#headerSavedList option[value="'+t+'"]').prop("selected",!0)}var t,n,i;if(typeof RESTFUL=="undefined")throw"restful.js must be used.";if(typeof jQuery=="undefined")throw"jquery must be used.";if(typeof prettyProcessing=="undefined")throw"prettyProcessing.js must be used.";t=new CONTACTLIST.EditingData;n=new JTable("#jTable");$("#i-text_editData").on("input",function(){$("#i_editData").val($(this).val())});$("#i-number_editData").on("input",function(){$("#i_editData").val($(this).val())});$("#i-money_editData").on("input",function(){$("#i_editData").val($(this).val())});$("#i-money_editData").on("input",function(){$("#i_editData").val($(this).val())});$("#i-date_editData").datetimepicker({format:"m/d/yyyy",linkField:"i_editData",linkFormat:"m/d/yyyy",type:"date"});$("#i-datetime_editData").datetimepicker({format:"m/d/yyyy H:ii P",showMeridian:!0,linkField:"i_editData",linkFormat:"m/d/yyyy H:ii P"});$("#i-time_editData").datetimepicker({format:"H:ii P",showMeridian:!0,pickDate:!1,linkField:"i_editData",linkFormat:"H:ii P"});$("#a_headers_delete").on("click",function(){$("#m_headerDelete").modal("show")});$("#b_headerDelete").on("click",function(){var i,t;($("#m_headerDelete").modal("hide"),i=$("#header_headerDelete").val(),typeof i!="undefined"&&i!=="")&&(t=new XMLHttpRequest,t.open("delete","../../Cloud2/ContactHeader",!0),RESTFUL.jsonHeader(t),RESTFUL.ajaxHeader(t),t.onerror=function(){RESTFUL.showError("There was an error deleting the header. 500 Internal server error.","Report Creation Error");prettyProccessing.hidePleaseWait()},t.onload=function(t){var u=t.currentTarget,r,f,i;if(u.status===200)if(r=RESTFUL.parse(u),r.Success){for(prettyProcessing.hidePleaseWait(),f=r.Id,i=0;i<n.Headers.length;i++)if(n.Headers[i].Id==f){n.Headers.splice(i,1);break}n.GetPage()}else RESTFUL.showError(r.Message,"Delete Header Error"),prettyProcessing.hidePleaseWait();else RESTFUL.showError("There was an error deleting the header.","Header Deletion Error"),prettyProcessing.hidePleaseWait()},prettyProcessing.showPleaseWait("Deleting Header","Deleting Header"),t.send(JSON.stringify({id:i})),n.GetPage())});$("#a_action_add").on("click",function(n){n.preventDefault();var t=$("#m_action");t.find("#b_action_add").show();t.find("#b_action_remove").hide();t.modal("show")});$("#a_action_remove").on("click",function(n){n.preventDefault();var t=$("#m_action");t.find("#b_action_add").hide();t.find("#b_action_remove").show();t.modal("show")});$("#b_action_add").on("click",function(){var i=$("#m_action"),t,n;i.modal("hide");prettyProcessing.showPleaseWait("Adding Contacts","Adding");t={id:$("#id_action").val()};t.ids=[];$(".jTable_selected:checked").each(function(){t.ids.push($(this).val())});AddJsonAntiForgeryToken(t);n=new XMLHttpRequest;n.open("post",window.location.origin+"/Cloud2/SavedListContacts",!0);RESTFUL.ajaxHeader(n);RESTFUL.jsonHeader(n);n.onerror=function(){prettyProcessing.hidePleaseWait();RESTFUL.showError()};n.onload=function(n){var t,i;prettyProcessing.hidePleaseWait();t=n.currentTarget;t.status===200?(i=RESTFUL.parse(t),i.Success||RESTFUL.showError(i.Message,"Adding Contact Error")):RESTFUL.showError()};n.send(JSON.stringify(t))});$("#b_action_remove").on("click",function(){var r=$("#m_action"),i,t;r.modal("hide");prettyProcessing.showPleaseWait("Removing Contacts","Adding");i={id:$("#id_action").val()};i.ids=[];$(".jTable_selected:checked").each(function(){i.ids.push($(this).val())});AddJsonAntiForgeryToken(i);t=new XMLHttpRequest;t.open("delete",window.location.origin+"/Cloud2/SavedListContacts",!0);RESTFUL.ajaxHeader(t);RESTFUL.jsonHeader(t);t.onerror=function(){prettyProcessing.hidePleaseWait();RESTFUL.showError()};t.onload=function(t){var r,u;prettyProcessing.hidePleaseWait();r=t.currentTarget;r.status===200?(u=RESTFUL.parse(r),u.Success?n.SavedId==i.id&&n.Load(window.location.origin+"/Cloud2/Contacts",{id:n.SavedId,type:"email list"}):RESTFUL.showError(u.Message,"Removing Contact Error")):RESTFUL.showError()};t.send(JSON.stringify(i))});i="SavedList";$("#file_createStaticList").on("click",function(n){n.preventDefault();i="SavedList";$("#m_fileSave").modal("show")});$("#file_createContactList").on("click",function(n){n.preventDefault();i="ContactList";$("#m_fileSave").modal("show")});$("#b_fileSave").on("click",function(){var t,u,r;if(prettyProcessing.showPleaseWait("Creating List","Creating"),$(this).closest(".modal").modal("hide"),t={name:$("#name_fileSave").val(),type:i},t.table=$.extend({},n),t.table.Rows=[],t.table.FilteredRows=[],t.table.FilterObject=null,t.table.SortingObject=null,t.contacts=[],i==="SavedList")for(u=0;u<n.FilteredRows.length;u++)t.contacts.push(n.FilteredRows[u].Id);r=new XMLHttpRequest;r.open("post",window.location.origin+"/Cloud2/EmailList",!0);RESTFUL.ajaxHeader(r);RESTFUL.jsonHeader(r);r.onerror=function(){prettyProcessing.hidePleaseWait();RESTFUL.showError()};r.onload=function(t){var i,r;prettyProcessing.hidePleaseWait();i=t.currentTarget;i.status===200?(r=RESTFUL.parse(i),r.Success?n.Load(window.location.origin+"/Cloud2/Contacts",{id:r.Id,type:"email list"}):RESTFUL.showError()):RESTFUL.showError()};AddJsonAntiForgeryToken(t);r.send(JSON.stringify(t))});$("#addHeader").on("click",function(){$(this).closest(".modal").modal("hide");prettyProcessing.showPleaseWait();$("#newHeader").modal("hide");var n={};n.Name=$("#headerName").val();n.Descriminator=$("#headerDescriminator").val();n.CompanyKey=CompanyKey;n.DescriminatorOptions=[];n.UId=$("#headerUId").val();n.SavedListKey=$("#headerSavedList").val();switch(n.Descriminator){case"datetimeoffset":n.DescriminatorOptions.push({Key:"timezone",Value:$("#headerTimezone").val()});break;case"decimal":n.DescriminatorOptions.push({Key:"culture",Value:$("#headerMoney").val()})}$.ajax({url:"../../Cloud2/ContactHeader",type:"post",data:AddJsonAntiForgeryToken(n),dataType:"json",success:function(n){prettyProcessing.hidePleaseWait();n.Success?window.location.reload():alert(n.Message)},error:function(){prettyProcessing.hidePleaseWait();alert("Server Error")}})});$("#headerDescriminator").on("change",function(){var n=$(this).val();n==="2"||n==="3"||n==="9"?$("#timezoneDiv").show():$("#timezoneDiv").hide();n==="5"?$("#moneyDiv").show():$("#moneyDiv").hide()});$("#a_headers_add").on("click",function(n){n.preventDefault();$("#m_headerModal").modal("show")});$("#addContact").on("click",function(){$("#newContact").modal("hide")});$("#a_contact_add").on("click",function(n){n.preventDefault();$("#newContact").modal("show")});$("#a_contact_delete").on("click",function(n){var i,t;n.preventDefault();prettyProcessing.showPleaseWait();i={};i.ids=[];$(".jTable_selected:checked").each(function(){i.ids.push($(this).val())});AddJsonAntiForgeryToken(i);t=new XMLHttpRequest;t.open("delete",window.location.origin+"/Cloud2/Contacts",!0);RESTFUL.ajaxHeader(t);RESTFUL.jsonHeader(t);t.onerror=function(){prettyProcessing.hidePleaseWait();RESTFUL.showError()};t.onload=function(n){var t,i;prettyProcessing.hidePleaseWait();t=n.currentTarget;t.status===200?(i=RESTFUL.parse(t),i.Success?window.location.reload():RESTFUL.showError(i.Message,"Removing Contact Error")):RESTFUL.showError()};t.send(JSON.stringify(i))});$("#file_load").on("click",function(){r(!0)});$("#b_editData").on("click",function(){var n=$.extend({},t),i;n.column.Value=$("#i_editData").val();$(this).closest(".modal").modal("hide");prettyProcessing.showPleaseWait("Saving Contact Data","Saving");i=new XMLHttpRequest;i.open("put",window.location.origin+"/Cloud2/ContactData",!0);RESTFUL.ajaxHeader(i);RESTFUL.jsonHeader(i);i.onerror=function(){RESTFUL.showError()};i.onload=function(t){var u,i,r,f;prettyProcessing.hidePleaseWait();u=t.currentTarget;u.status===200?(i=RESTFUL.parse(u),i.Success?(n.column.Value=i.Value,n.column.PrettyValue=i.PrettyValue,n.column.Id=i.Id,r=$("#"+n.row.Id+"_"+n.header.Id),r.length==0&&(f=$("#"+n.row.Id),r=f.find('td[data-headerid="'+n.header.Id+'"]'),r.attr("id",n.row.Id+"_"+n.header.Id)),r.html(n.column.PrettyValue)):RESTFUL.showError()):RESTFUL.showError()};AddJsonAntiForgeryToken(n);i.send(JSON.stringify(n))});n.OnGetComplete=function(){var r,i;$(".jTable_contact-link").each(function(){$(this).attr("href",window.location.origin+"/Cloud2/Contact/"+$(this).attr("data-id"))});$("#jTable_selectAll").on("change",function(){var n=$(this);$(".jTable_selected").prop("checked",n.prop("checked"))});$(".editable-item").on("click",function(){var c=$(this),l=$(this).parent("tr"),a=l.attr("id"),s=c.attr("data-headerid"),i,f,h,r,e,o,u,v;if(t.row=FindRow(n,a),t.column=FindColumn(t.row,s),t.column===null&&(t.column=new JTableColumn,t.column.Id=null,t.column.HeaderId=s,t.column.Editable=!0,t.row.Columns.push(t.column)),i=FindHeader(n,s),t.header=i,i!==null){if($(".header-input").hide(),i.Type==="date")$(".header-date").show();else if(i.Type==="time")$(".header-time").show();else if(i.Type==="datetime")$(".header-datetime").show();else if(i.Type==="number")$(".header-number").show();else if(i.Type==="money")$(".header-money").show();else if(i.Type==="itemParent"){for(f=$(".header-itemparent"),f.html(""),h="",r=0;r<i.PossibleValues.length;r++)h+='<label class="control-label col-sm-12"><input value="'+i.PossibleValues[r].Id+'" type="radio" name="item-single-selection" class=".item-single-selection" /> '+i.PossibleValues[r].Label+"<\/label>";f.html(o);$(".item-single-selection").on("change",function(){$("#i_editData").val($(".item-single-selection:checked").val())});f.show()}else if(i.Type==="multipleSelection"){for(e=$(".header-itemparent"),e.html(""),o="",u=0;u<i.PossibleValues.length;u++)o+='<label class="control-label col-sm-12"><input value="'+i.PossibleValues[u].Id+'" type="checkbox" class=".item-multiple-selection" /> '+i.PossibleValues[u].Label+"<\/label>";$(".item-multiple-selection").on("change",function(){var n=[];$(".item-multiple-selection:checked").each(function(){n.push($(this).val())});$("#i_editData").val(JSON.stringify(n))});e.html(o);e.show()}else $(".header-text").show(),$("#i-text_editData").val(t.column.Value);($("#i_editData").val(t.column.Value),t.row!==null)&&(v=$("#m_editData"),$("#m_editData").modal("show"))}});for(r='<option value="">Select a Header<\/option>',i=0;i<n.Headers.length;i++)r+='<option value="'+n.Headers[i].Id+'">'+n.Headers[i].Label+"<\/option>";$("#header_headerDelete").html(r)};n.GenerateTableHtml=function(n,t){for(var o,i,h,s,f,r='<thead><tr><td><input type="checkbox" id="jTable_selectAll" /><\/td>',u=0;u<n.Headers.length;u++)if((!(n.Average||n.Graph||n.Count)||!n.Headers[u].Hidden)&&!n.Headers[u].Removed){var e=n.Headers[u].Group;e=typeof e!="undefined"&&e!==null&&e!==""?"<i>"+e+"<\/i><br />":"";r+='<th class="cursor-pointer sortable-header" data-header-id="'+n.Headers[u].Id+'">'+e+n.Headers[u].Label+"<\/th>"}for(r+="<\/tr><\/thead><tbody>",o=0;o<t.length;o++){for(r+='<tr id="'+t[o].Id+'"><td><input type="checkbox" class="jTable_selected" value="'+t[o].Id+'" />',i=0;i<n.Headers.length;i++)(n.Average||n.Graph||n.Count)&&n.Headers[i].Hidden||n.Headers[i].Removed||(h=n.Headers[i].Editable,(n.Average||n.Graph||n.Count)&&(h=!1),s=FindColumn(t[o],n.Headers[i].Id),typeof s!="undefined"&&s!==null?(f=s.PrettyValue,!this.Graph&&!this.Count&&!this.Average&&f!==null&&f.indexOf("<a")!==0&&f.length>100&&(f=f.substr(0,100)+"..."),r+='<td data-headerid="'+n.Headers[i].Id+'" id="'+s.Id+'" class="'+(h?"editable-item cursor-pointer":"")+'">'+f+"<\/td>"):r+='<td data-headerid="'+n.Headers[i].Id+'" class="'+(h?"editable-item cursor-pointer":"")+'"><\/td>');r+="<\/tr>"}return r+"<\/tbody>"};n.Load(window.location.origin+"/Cloud2/Contacts",TABLE_options);$("#downloadReport").on("click",function(){var r={id:n.Id,average:$("#averages").prop("checked"),filters:n.Filters,sortings:n.Sortings,graph:$("#graphs").prop("checked")},i=$.extend({},n),t=new XMLHttpRequest;t.open("post","../../Cloud2/Create/Report");RESTFUL.jsonHeader(t);RESTFUL.ajaxHeader(t);t.onerror=function(){RESTFUL.showError("There was an error creating the report. 500 Internal server error.","Report Creation Error");prettyProccessing.hidePleaseWait()};t.onload=function(n){var i=n.currentTarget,t;i.status===200?(t=RESTFUL.parse(i),t.Success?(prettyProcessing.hidePleaseWait(),window.location=window.location.origin+"/Cloud2/Download/Report/"+t.Id):(RESTFUL.showError("There was an error creating the report.","Report Creation Error"),prettyProccessing.hidePleaseWait())):(RESTFUL.showError("There was an error creating the report.","Report Creation Error"),prettyProccessing.hidePleaseWait())};prettyProcessing.showPleaseWait("Creating Form Report","Creating Report");i.FilteredRows=[];i.Rows=[];i.FilterObject=null;i.SortingObject=null;t.send(JSON.stringify(AddJsonAntiForgeryToken(i)))});$("#printable").on("click",function(t){t.preventDefault();n.GetPrintView()})});
//# sourceMappingURL=ContactList.min.js.map
