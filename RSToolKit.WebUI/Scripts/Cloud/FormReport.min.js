var FORMREPORT_VERSION=null;$(document).on("ready",function(){function f(){$(".form-component").removeClass("col-sm-6").removeClass("col-md-4").removeClass("col-lg-3").addClass("col-sm-12");$('input[data-component-type="datetime"]').datetimepicker();$('input[type="hidden"][data-component-type="checkboxgroup"]').each(function(){var t=$(this),n=t.val(),i;(typeof n=="undefined"||n==="")&&(n="[]");i=JSON.parse(n);t.data("value",i)});$('input[type="checkbox"]').on("change",function(){var t=$(this),r,n,o,s,u,f,i;if(!/Waitlistings/i.test(t.attr("name"))){if(r=$("#"+t.attr("data-parent")),n=r.data("value"),t.prop("checked")){if(o=!0,i=n.indexOf(t.val()),i==-1&&n.push(t.val()),r.attr("data-component-timeexclusion")==="True"){for(s=!1,u=0;u<n.length;u++){var h=$("#"+n[u]),c=moment(h.attr("data-agenda-start")),l=moment(h.attr("data-agenda-end"));for(f=0;f<n.length;f++)if(n[u]!==n[f]){var a=$("#"+n[f]),v=moment(a.attr("data-agenda-start")),e=moment(a.attr("data-agenda-end"));(e.isAfter(c)||e.isSame(c))&&(e.isBefore(l)||e.isSame(l))&&(s=!0)}}s&&(o=!1)}o||(n.splice(i,1),t.prop("checked",!1),alert("Your selection has time conflictions."))}else i=n.indexOf(t.val()),i!=-1&&n.splice(i,1);r.data("value",n);r.val(JSON.stringify(n))}});$('input[data-component-type="radiogroup"][type="hidden"]').each(function(){});$('input[type="radio"]').on("change",function(){var n=$(this),t=$("#"+n.attr("data-parent"));n.prop("checked")&&t.val(n.val())});$(".uploaded-image").each(function(){$.ajax({type:"Get",url:"../../Cloud/RegistrantImageThumbnail/"+$(this).attr("data-form-registrant")+"?component="+$(this).attr("data-form-component"),success:function(n){$(this).attr("src",n)}})})}function e(){$(".editable-item").on("click",function(){$("#editModal .modal-body").find("#editingProgress").show();$("#editModal .modal-body").find("#editingData").hide();$("#editModal").modal("show");t.id=$(this).attr("data-headerid");t.regKey=$(this).parent("tr").attr("id");t.value=$(this).html();$(this).hasClass("file")?setTimeout(function(){u(t.id,t.regKey)},1e3):u(t.id,t.regKey)});$('a[href="#emailSend"]').on("click",function(n){n.preventDefault();var t=$(this).attr("data-emailsend-id");EmailSendInformation.load(t)})}function u(n,i){var r=$("#editModal .modal-dialog").width()-62;$.ajax({url:"../../Cloud/EditComponent/"+n+"?registrantKey="+i+"&width="+r,type:"get",contentType:"application/json",dataType:"json",success:function(n){n.Success?($("#editModal").find("#editingData").html(n.Html).show("fast"),$("#editModal").find("#editingProgress").hide("fast"),f()):($("#editModal").modal("hide"),t.Id=null,t.regKey=null,alert(n.Message))},error:function(){processing.hidePleaseWait();t.Id=null;t.regKey=null;alert("Server Error")}})}var t,n,i,r;if(FORMREPORT_VERSION="1.4.0.0",t={id:null,regKey:null,value:null,isSecure:!1},n=new JTable,typeof RESTFUL=="undefined")throw"restful.js must be used.";if(typeof jQuery=="undefined")throw"jquery must be used.";if(typeof prettyProcessing=="undefined")throw"prettyProcessing.js must be used.";if(typeof SORTING_VERSION=="undefined")throw"Sorting.js must be used.";if(typeof FILTER_VERSION=="undefined")throw"Filter.js must be used.";$.extend(n,rawTable);i=new Sorting(n);r=new Filter(n);n.OnGetComplete=function(){e();$(".balance").on("click",function(){prettyProcessing.showPleaseWait("Registrant Invoice","Getting Data");var n=new XMLHttpRequest,t=$(this).closest("tr");n.open("get","../RegistrantInvoice/"+t.attr("id"));n.onerror=function(){RESTFUL.showError("500 Internal Server Error","Registrant Invoice Error");prettyProcessing.hidePleaseWait()};n.onload=function(n){var i=n.currentTarget,t;i.status===200?(t=RESTFUL.parse(i),t.Success?(prettyProcessing.hidePleaseWait(),$("#invoiceModal").find(".modal-body").html(t.Html),$("#invoiceModal").modal("show")):(RESTFUL.showError(t.Message,"Registrant Invoice Error"),prettyProcessing.hidePleaseWait())):(RESTFUL.showError("500 Internal Server Error","Registrant Invoice Error"),prettyProcessing.hidePleaseWait())};n.send()})};n.GetPage();$("#pageSize").on("blur",function(){var t=$(this).val();isNaN(t)?($(this).val(25),n.RecordsPerPage=25,n.GetPage()):(n.RecordsPerPage=parseInt(t),n.GetPage())});$("#pageLeft").on("click",function(){n.Page!==1&&(n.Page--,$("#jTable_pageNumber").val(n.Page),n.GetPage())});$("#pageRight").on("click",function(){n.Page!==n.TotalPages()&&(n.Page++,$("#jTable_pageNumber").val(n.Page),n.GetPage())});$("#jTable_pageNumber").on("change",function(){n.Page=parseInt($(this).val());n.GetPage()});$("#averages").on("change",function(){n.Average=$(this).prop("checked");n.GetPage()});$("#graphs").on("change",function(){n.Graph=$(this).prop("checked");n.GetPage()});$("#count").on("change",function(){n.Count=$(this).prop("checked");n.GetPage()});$("#downloadReport").on("click",function(){var r={id:n.Id,average:$("#averages").prop("checked"),filters:n.Filters,sortings:n.Sortings,graph:$("#graphs").prop("checked")},i=$.extend({},n),t=new XMLHttpRequest;t.open("post","../Create/FormReport");RESTFUL.jsonHeader(t);t.onerror=function(){RESTFUL.showError("There was an error creating the report. 500 Internal server error.","Report Creation Error");prettyProccessing.hidePleaseWait()};t.onload=function(n){var i=n.currentTarget,t;i.status===200?(t=RESTFUL.parse(i),t.Success?(prettyProcessing.hidePleaseWait(),window.open(window.location.origin+"/Cloud/Download/Report/"+t.Id)):(RESTFUL.showError("There was an error creating the report.","Report Creation Error"),prettyProccessing.hidePleaseWait())):(RESTFUL.showError("There was an error creating the report.","Report Creation Error"),prettyProccessing.hidePleaseWait())};prettyProcessing.showPleaseWait("Creating Form Report","Creating Report");i.FilteredRows=[];i.Rows=[];t.send(JSON.stringify(AddJsonAntiForgeryToken(i)))});$("#saveEdit").on("click",function(){var o,u,f,s,e,r,h,i;for($("#editModal").find("#editingData").hide("fast"),$("#editModal").find("#editingProgress").show("fast"),o=[],u=0;$('input[name^="Waitlistings['+u+']"]').length>0;){for(f={},s=$('input[name^="Waitlistings['+u+']"]'),e=0;e<s.length;e++)r=$(s[e]),/Key$/i.test(r.attr("name"))?f.Key=r.val():r.attr("type")==="checkbox"&&(f.Value=r.prop("checked")?!0:!1);u++;o.push(f)}h={ComponentKey:t.id,RegistrantKey:t.regKey,Value:$("#"+t.id).val(),Waitlistings:o};AddJsonAntiForgeryToken(h);i=new XMLHttpRequest;i.open("put","../../Cloud/SaveRegistrantData",!0);RESTFUL.jsonHeader(i);i.onerror=function(n){RESTFUL.xhrError(n)};i.onload=function(i){var u,f,e,r;if(c_xhr=i.currentTarget,c_xhr.status===200)if(u=RESTFUL.parse(c_xhr),u.Success){for($("#"+t.regKey).find('td[data-headerid="'+t.id+'"]').html(u.NewValue),r=0;r<n.Rows.length;r++)if(n.Rows[r].Id===t.regKey)for(f=0;f<n.Rows[r].Columns.length;f++)n.Rows[r].Columns[f].HeaderId===t.id&&(n.Rows[r].Columns[f].Value=u.NewValue,n.Rows[r].Columns[f].PrettyValue=u.NewValue);$("#editModal").modal("hide")}else{for($("#editModal .modal-body").find("#editingProgress").hide("fast"),$("#editModal .modal-body").find("#editingData").show("fast"),e="",r=0;r<u.Errors.length;r++)r!=0&&(e+="<br />"),e+=u.Errors[r];$("#editModal").find(".form-messagebox").html(e).show("fast")}else $("#editModal").modal("hide"),RESTFUL.showError("Unhandled Server Error")};i.send(JSON.stringify(h))});$("#sortings_clearall").on("click",function(t){t.preventDefault();n.Sortings=[];i.Generate();n.Sorted=!1;n.GetPage()});$("#sortings_edit").on("click",function(n){n.preventDefault();i.Modal.modal("show")});$("#filters_clearall").on("click",function(t){t.preventDefault();n.Filters=[];r.Generate();n.Filtered=!1;n.GetPage()});$("#filters_edit").on("click",function(n){n.preventDefault();r.Modal.modal("show")});$("#printable").on("click",function(t){t.preventDefault();n.GetPrintView()});(typeof n.SavedId=="undefined"||this.SavedId===null)&&($("#file_save").css("color","#e6e6e6"),$("#file_delete").css("color","#e6e6e6"));$("#formType").on("change",function(){var u,t,i,r,f,e,o,s,h,c,l;n.Filters=[];switch($(this).val()){case"all":n.Name="All Registrations";break;case"active":n.Name="Active Registrations";u=new JTableFilter;u.ActingOn="status";u.Value="1";u.Test="==";u.Order=1;n.Filters.push(u);break;case"canceled":n.Name="Canceled Registrations";t=new JTableFilter;t.GroupNext=!0;t.ActingOn="status";t.Order=1;t.Test="==";t.Link="or";t.Value="2";i=new JTableFilter;i.GroupNext=!0;i.ActingOn="status";i.Order=3;i.Test="==";i.Link="or";i.Value="3";r=new JTableFilter;r.GroupNext=!1;r.ActingOn="status";r.Order=4;r.Test="==";r.Link="or";r.Value="4";n.Filters.push(t);n.Filters.push(i);n.Filters.push(r);break;case"incompletes":n.Name="Incomplete Registrations";f=new JTableFilter;f.ActingOn="status";f.Value="0";f.Test="==";f.Order=1;n.Filters.push(f);break;case"deleted":n.Name="Deleted Registrations";e=new JTableFilter;e.ActingOn="status";e.Value="5";e.Test="==";e.Order=1;n.Filters.push(e);break;case"unbalanced":n.Name="Unbalanced Accounts";o=new JTableFilter;o.ActingOn="balance";o.Value="0";o.Test="!=";o.Order=1;n.Filters.push(o);break;case"refund":n.Name="Refunds Due";s=new JTableFilter;s.ActingOn="balance";s.Value="0";s.Test="<";s.Order=1;n.Filters.push(s);break;case"owed":n.Name="Balances Due";h=new JTableFilter;h.ActingOn="balance";h.Value="0";h.Test=">";h.Order=1;n.Filters.push(h);break;case"rsvpAccept":n.Name="RSVP Accept";c=new JTableFilter;c.ActingOn="rsvp";c.Value="True";c.Test="==";c.Order=1;n.Filters.push(c);break;case"rsvpDecline":n.Name="RSVP Decline";l=new JTableFilter;l.ActingOn="rsvp";l.Value="False";l.Test="==";l.Order=1;n.Filters.push(l)}n.Filtered=!1;n.GetPage()});$("#downloadReport").on("click",function(n){n.preventDefault();report.Registrants=[];report.Fileds=[];window.location="../../Cloud/DownloadFormReport?rawJson="+JSON.stringify(report)})});
//# sourceMappingURL=FormReport.min.js.map
