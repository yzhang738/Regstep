function LoadEmailLists(){$.ajax({url:"../Cloud/GetEmailLists",type:"post",data:JSON.stringify({cid:CurrentCompany}),contentType:"application/json",dataType:"json",traditional:"true",success:function(n){if(n.Success){$("#activeEmailList").html("");for(var t=0;t<n.Data.length;t++)$("#activeEmailList").append('<option value="'+n.Data[t].UId+'">'+n.Data[t].Name+"<\/option>")}}})}function LoadEmails(){$("#mainHolder > section").html('<div class="row"><div class="col-md-12"><h3 class="text-center">Loading Data...<\/h3><\/div><\/div>');var n="",t=searchInformation;$.ajax({url:"../Cloud/GetEmailListEmails",type:"post",data:JSON.stringify(t),contentType:"application/json",dataType:"json",traditional:"true",success:function(t){var u,r,e,i,f;if(t.Success){for(customers=t.Data,searchInformation=t.Information,filters=[];currentFilters.length>0;)currentFilters.pop();if(searchInformation.Filters!==null)for(i=0;i<searchInformation.Filters.length;i++)currentFilters.push(searchInformation.Filters[i]);if(t.Data.length<0)return;for($("#page").html(""),u=1;u<=searchInformation.TotalPages;u++)$("#page").append('<option value="'+u+'">'+u+"<\/option>");if($("#page").val(""+searchInformation.Page),t.Data.length==0){$("#mainHolder > section").html('<div class="row"><div class="col-md-12"><h3 class="text-center">No Customers Matches Criteria<\/h3><\/div><\/div>');return}for(n+='<div class="table-responsive"><table class="table table-striped table-registration-data"><thead class="dataHeader"><tr>',n+='<th class="no-wrap el-action-td">ELA<\/th>',i=0;i<t.Data[0].Data.length;i++){filters.push(t.Data[0].Data[i].Key);r=t.Data[0].Data[i].Key;r=r.replace(/_/g," ");e="";switch(t.Data[0].Data[i].Key){case"Email":break;case"FirstName":r="First Name";break;case"LastName":r="Last Name";break;case"PhoneNumber":r="Phone Number";break;case"Address":break;case"Address2":r="Address Line 2";break;case"City":break;case"State":break;case"ZipCode":r="Zip Code";break;default:e=" deletable"}n+='<th data-id="'+t.Data[0].Data[i].Key+'" class="no-wrap'+e+'">'+r+"<\/th>"}for(n+="<\/thead><tbody>",i=0;i<t.Data.length;i++){for(n+='<tr data-id="'+t.Data[i].Id+'" data-uid="'+t.Data[i].UId+'" data-index="'+i+'">',n+='<td class="el-action-td el-action-click pointer text-center editable" data-el-id="'+t.Data[i].UId+'"><\/td>',f=0;f<t.Data[i].Data.length;f++)n+='<td data-horizontal="'+f+'"  onclick="EditData(this, event)" class="editable no-wrap">'+t.Data[i].Data[f].Value+"<\/td>";n+="<\/tr>"}n+="<\/tbody><\/table><\/div>";$("#mainHolder > section").html(n);SetUpFilters();SetUpEmailListActions();ClickHeaders()}else $("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">'+t.Message+"<\/div><\/div>"),$("#informationModal").modal("show")},error:function(){$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">Internal Server Error<\/div><\/div>');$("#informationModal").modal("show")}})}function SetUpEmailListActions(){if(searchInformation.UId!=null&&searchInformation.UId!="00000000-0000-0000-0000-000000000000"){for(var n=0;n<customers.length;n++)$('.el-action-td[data-el-id="'+customers[n].UId+'"]').html('<span data-id="'+customers[n].UId+'" class="el-action el-action-add glyphicon glyphicon-minus-sign"><\/span>');$(".el-action-click").on("click",function(){ELAction(this)});$(".el-action-td").show()}else $(".el-action-td").hide()}function ELAction(n){var t=$(n).children("span"),i=$(t).attr("data-id");$.ajax({url:"../Cloud/RemoveCustomerFromEmailList",type:"post",data:JSON.stringify({cid:CurrentCompany,cuid:i,elid:searchInformation.UId}),contentType:"application/json",dataType:"json",traditional:"true",success:function(n){n.Success&&($(t).addClass("el-action-add"),$(t).removeClass("el-action-remove"),$(t).removeClass("glyphicon-minus-sign"),$(t).addClass("glyphicon-plus-sign"));LoadEmails()}})}function EditData(n){var t=parseInt($(n).attr("data-horizontal"));currentIndex=$(n).parent().attr("data-index");currentHorizontal=t;$("#editHeader").val(customers[currentIndex].Data[t].Key);$("#editVal").val(customers[currentIndex].Data[t].Value);$("#editData").modal("show")}function ClickHeaders(){$(".dataHeader th").on("click",function(){var n=$(this).attr("data-id"),t=!0;searchInformation.Sortings[0].ActingOn==n&&(t=!searchInformation.Sortings[0].Descending);searchInformation.Sortings[0].ActingOn=n;searchInformation.Sortings[0].Descending=t;searchInformation.Sortings=[{ActingOn:n,Descending:t,Priority:1}];$(this).parent(".dataHeader").children(".sort").remove();LoadEmails()});span=searchInformation.Sortings[0].Descending?' <span class="sort glyphicon glyphicon-arrow-down"><\/span>':' <span class="sort glyphicon glyphicon-arrow-up"><\/span>';$('.dataHeader th[data-id="'+searchInformation.Sortings[0].ActingOn+'"]').append(span)}var searchInformation={Page:1,RecordsPerPage:25,Company:CurrentCompany,Sortings:[{ActingOn:"Id",Descending:!0,Priority:1}],Filters:null,TotalRecords:-1,TotalPages:-1,UId:null},customers;$(document).ready(function(){LoadEmailLists();$("#recordsPerPage").on("blur",function(){searchInformation.RecordsPerPage=$(this).val();searchInformation.Page=1;LoadEmails()});$("#page").on("change",function(){searchInformation.Page=$(this).val();LoadEmails()});$("#pageLeft").on("click",function(){searchInformation.Page>1&&(searchInformation.Page--,$("#page").val(searchInformation.Page),LoadEmails())});$("#pageRight").on("click",function(){searchInformation.Page<searchInformation.TotalPages&&(searchInformation.Page++,$("#page").val(searchInformation.Page),LoadEmails())});$("#activeEmailList").on("change",function(){searchInformation.UId=$(this).val();LoadEmails()});$("#deleteList").on("click",function(){searchInformation.UId!==null&&searchInformation.UId!="00000000-0000-0000-0000-000000000000"&&$.ajax({url:"../Cloud/DeleteEmailList",type:"post",data:JSON.stringify({cid:CurrentCompany,elid:searchInformation.UId}),contentType:"application/json",dataType:"json",traditional:"true",success:function(n){n.Success?(searchInformation.UId="00000000-0000-0000-0000-000000000000",$("#mainHolder > section").html('<div class="row"><div class="col-sm-12"><h3 class="text-center">No List Selected<\/h3><\/div><\/div>'),LoadEmailLists()):($("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">'+n.Message+"<\/div><\/div>"),$("#informationModal").modal("show"))},error:function(){$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">Internal Server Error<\/div><\/div>');$("#informationModal").modal("show")}})});$("#changeFilters").on("click",function(){$("#filterModal").modal("show")});$("#filterNow").on("click",function(){searchInformation.Filters=currentFilters;searchInformation.Page=1;LoadEmails()});$("#editVal").keyup(function(n){n.which==13&&$("#editDataSave").trigger("click");n.which==27&&$("#editData").modal("hide")});$("#editData").on("shown.bs.modal",function(){$("#editVal").focus()});$("#editDataSave").on("click",function(){var i=$("tr[data-index="+currentIndex+"]"),r=$(i).children("[data-horizontal="+currentHorizontal+"]"),n=$("#editVal").val(),t;customers[currentIndex].Data[currentHorizontal].Value=n;$(r).html(n);t={Company:CurrentCompany,Data:customers[currentIndex]};$.ajax({url:"../RSCloud/SaveCustomer",type:"post",data:JSON.stringify(t),contentType:"application/json",dataType:"json",traditional:"true",success:function(n){n.Success||($("#saveError #saveMessage").html(n.Message),$("#saveError").modal())},error:function(){$("#saveError").modal("show");$("#saveMessage").html("")}})})});
//# sourceMappingURL=EmailLists.min.js.map
