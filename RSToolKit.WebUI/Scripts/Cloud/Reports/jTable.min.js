/*! JTable v1.3.1.0         */
/*! Created By: D.J. Enzyme */
/*! Creation Date: 20141229 */
/*! Modified Date: 20150331 */
function JTable(n,t){"use strict";var r=++JTables.tableIndex,u=!1,i,f;if(typeof t=="boolean"&&(u=t),this.Table=n,(typeof n=="undefined"||n==null)&&(this.Table="#jTable"+r),i=this,f="",!u){$("body").append(GenerateHeaderDiv("headerSelection"+r));$("#headerSelection"+r).find(".add-header").on("click",function(n){n.preventDefault();var t=$("#headerSelection"+r);t.find(".header-available:checked").each(function(){for(var t,r,f=$(this).val(),u=!1,n=0;n<i.Headers.length;n++)t=i.Headers[n],t.Id===f&&(u=!0,t.Removed=!1);u&&(r=$(this).closest("label"),r.find("input").removeClass("header-available").addClass("header-selected"),r.parent().appendTo(".headers-container-selected"),$(".headers-container-selected .header-move").show(),$(".headers-container-selected .header-div").first().find(".header-up").hide(),$(".headers-container-selected .header-div").last().find(".header-down").hide())});t.find(".header-item").prop("checked",!1)});$("#headerSelection"+r).find(".remove-header").on("click",function(n){n.preventDefault();var t=$("#headerSelection"+r);$(".header-selected:checked").each(function(){for(var r,n,f=$(this).val(),u=!1,t=0;t<i.Headers.length;t++)r=i.Headers[t],r.Id===f&&(u=!0,r.Removed=!0);u&&(n=$(this).closest("label"),n.find("input").removeClass("header-selected").addClass("header-available"),n.parent().appendTo(".headers-container-available"),n.parent().find(".header-move").hide())});$(".header-item").prop("checked",!1)});$("#headerSelection"+r).on("show.bs.modal",function(){var t=$(this),u,r,n;for(t.find(".headers-container-selected").html(""),t.find(".headers-container-available").html(""),u=i.Headers.sort(function(n,t){return n.Order-t.Order}),r=0;r<u.length;r++){if(n=u[r],n.Id==="confirmation"){t.find(".headers-container-selected").append('<label style="display: none;"><input type="checkbox" value="'+n.Id+'" class="header-item header-selected" />'+n.Label+"<\/label>");continue}n.Removed?t.find(".headers-container-available").append('<div class="header-div" data-id="'+n.Id+'"><label><input type="checkbox" value="'+n.Id+'" class="header-item header-available" />'+n.Label+'<\/label> <span class="header-move header-up cursor-pointer glyphicon glyphicon-arrow-up" data-id="'+n.Id+'"><\/span> <span class="header-move header-down cursor-pointer glyphicon glyphicon-arrow-down" data-id="'+n.Id+'"><\/span><\/div>'):t.find(".headers-container-selected").append('<div class="header-div" data-id="'+n.Id+'"><label><input type="checkbox" value="'+n.Id+'" class="header-item header-selected" />'+n.Label+'<\/label> <span class="header-move header-up cursor-pointer glyphicon glyphicon-arrow-up" data-id="'+n.Id+'"><\/span> <span class="header-move header-down cursor-pointer glyphicon glyphicon-arrow-down" data-id="'+n.Id+'"><\/span><\/div>')}t.find(".headers-container-available .header-move").hide();t.find(".headers-container-selected .header-div").first().find(".header-up").hide();t.find(".headers-container-selected .header-div").last().find(".header-down").hide();$(".header-move").on("click",function(){var t=$(this),u=t.attr("data-id"),n=$(this).parent(),i=n.prev(),r=n.next();if(t.hasClass("header-up")){if(i.length===0)return;n.insertBefore(i)}else{if(r.length===0)return;n.insertAfter(r)}$(".headers-container-selected .header-move").show();$(".headers-container-selected .header-div").first().find(".header-up").hide();$(".headers-container-selected .header-div").last().find(".header-down").hide()})});$("#headerSelection"+r).find(".headers-set").on("click",function(){$(this).closest(".modal").modal("hide");var n=0;$(".headers-container-selected .header-div").each(function(){var t=FindHeader(i,$(this).attr("data-id"));t!==null&&(t.Order=++n)});$(".headers-container-available .header-div").each(function(){var t=FindHeader(i,$(this).attr("data-id"));t!==null&&(t.Order=++n)});i.GetPage()});$('.jTable_headers-edit[data-jtable-target="'+this.Table+'"]').on("click",function(n){n.preventDefault();$("#headerSelection"+r).modal("show")});$('.jTable_pageLeft[data-jtable-target="'+this.Table+'"]').on("click",function(){i.Page!==1&&(i.Page--,$('.jTable_pageSelect[data-jtable-target="'+this.Table+'"]').val(i.Page),i.GetPage())});$('.jTable_pageRight[data-jtable-target="'+this.Table+'"]').on("click",function(){i.Page!==i.TotalPages()&&(i.Page++,$('.jTable_pageSelect[data-jtable-target="'+this.Table+'"]').val(i.Page),i.GetPage())});$('.jTable_pageSelect[data-jtable-target="'+this.Table+'"]').on("change",function(){i.Page=parseInt($(this).val());i.GetPage()});$('.jTable_recordsPerPage[data-jtable-target="'+this.Table+'"]').on("blur",function(){var n=$(this).val();isNaN(n)?($(this).val(25),i.RecordsPerPage=25,i.GetPage()):(i.RecordsPerPage=parseInt(n),i.GetPage())});$('.jTable_average[data-jtable-target="'+this.Table+'"]').on("change",function(){i.Average=$(this).prop("checked");i.GetPage()});$('.jTable_graph[data-jtable-target="'+this.Table+'"]').on("change",function(){i.Graph=$(this).prop("checked");i.GetPage()});$('.jTable_count[data-jtable-target="'+this.Table+'"]').on("change",function(){i.Count=$(this).prop("checked");i.GetPage()});$('.jTable_sortings-clearAll[data-jtable-target="'+this.Table+'"]').on("click",function(n){n.preventDefault();i.Sortings=[];i.SortingObject.Generate();i.Sorted=!1;i.GetPage()});$('.jTable_sortings-edit[data-jtable-target="'+this.Table+'"]').on("click",function(n){n.preventDefault();i.SortingObject.Modal.modal("show")});$('.jTable_filters-clearAll[data-jtable-target="'+this.Table+'"]').on("click",function(n){n.preventDefault();i.Filters=[];i.FilterObject.Generate();i.Filtered=!1;i.GetPage()});$('.jTable_filters-edit[data-jtable-target="'+this.Table+'"]').on("click",function(n){n.preventDefault();i.FilterObject.Modal.modal("show")});$('.jTable_favorite[data-jtable-target="'+this.Table+'"]').on("click",function(){i.Favorite?($(this).html('<span class="glyphicon glyphicon-star-empty"><\/span> Favorite'),i.Favorite=!1):($(this).html('<span class="glyphicon glyphicon-star"><\/span> Un-Favorite'),i.Favorite=!0)});$('.jTable_headers-clearAll[data-jtable-target="'+this.Table+'"]').on("click",function(n){var t,r;for(n.preventDefault(),t=0;t<i.Headers.length;t++)(r=i.Headers[t],r.Id!=="confirmation")&&(r.Removed=!0);i.GetPage()});$('.jTable_headers-addAll[data-jtable-target="'+this.Table+'"]').on("click",function(n){var t,r;for(n.preventDefault(),t=0;t<i.Headers.length;t++)r=i.Headers[t],r.Removed=!1;i.GetPage()})}this.LastFullCheck=moment();this.SortingObject=new Sorting(this,null,u);this.FilterObject=new Filter(this,null,u);this.Options={};this.Average=!1;this.Graph=!1;this.Count=!1;this.Headers=[];this.Rows=[];this.Parent="New Table";this.Name="New Table";this.Description="";this.Id="";this.RecordsPerPage=250;this.TotalRecords=0;this.Sortings=[];this.Filters=[];this.Page=1;this.Filtered=!1;this.Sorted=!1;this.SavedId=null;this.Favorite=!1;this.FilteredRows=[];this.FilteredRecords=function(){return this.FilteredRows.length};this.TotalPages=function(){var n=Math.ceil(this.FilteredRows.length/this.RecordsPerPage);return n===0?1:n};this.OnGetComplete=function(){};this.GetPage=function(n,t){var r,o,p,a,w,u,v,s,l,b,e;for(typeof n=="undefined"&&(n=this.Table),/^\./.test(n)||/^#/.test(n)||(n="#"+n),typeof t=="undefined"&&(t=this.Page),this.Filtered||this.Filter(),this.Sorted||this.Sort(),t>this.TotalPages()&&t!==1&&(t=1),r=[],$(".jTable_pageSelect").html(i.FilteredRecords()),$(".jTable_pageSelect").html(""),o=0;o<this.TotalPages();o++)$(".jTable_pageSelect").append('<option value="'+(o+1)+'" '+(this.Page===o+1?'selected="selected"':"")+">"+(o+1)+"<\/option>");for(p=(t-1)*this.RecordsPerPage,a=[],this.Headers.sort(function(n,t){return n.Order-t.Order}),a=this.Count?this.GetCount(this,r):this.Average?this.GetAverage(this,r):this.Graph?this.GetGraph(this,r):this.GetNormal(this,p),w=this.GenerateTableHtml(this,a),$(n).html(w),u=0;u<r.length;u++){v="<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<segments.length; i++){%><li><span style=\"background-color:<%=segments[i].fillColor%>\"><\/span><%if(segments[i].label){%><b><%=segments[i].label%><\/b>: <%=+(Math.round(((segments[i].value / total) * 100) + 'e+2')  + 'e-2')%>%<%}%><\/li><%}%><\/ul>";this.Count&&(v='<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"><\/span><%if(segments[i].label){%><b><%=segments[i].label%><\/b>: <%=segments[i].value%><%}%><\/li><%}%><\/ul>');s={};l={};switch(r[u].type){case"pie":s=$("#"+r[u].id).get(0).getContext("2d");l=new Chart(s).Pie(r[u].data,{legendTemplate:v});b=l.generateLegend();$("#"+r[u].id).parent().parent().children(".legend").html(b);break;case"bar":var k=10,y=100,f=100,h={},c=r[u].data;if(this.Count){for(e=0;e<c.datasets[0].data.length;e++)y<c.datasets[0].data[e]&&(y=c.datasets[0].data[e]),f>c.datasets[0].data[e]&&(f=c.datasets[0].data[e]);f=f-10-f%10;f<0&&(f=0)}else f=0;h.scaleOverride=!0;h.scaleSteps=Math.ceil((y-f)/k);h.scaleStepWidth=k;h.scaleStartValue=f;s=$("#"+r[u].id).get(0).getContext("2d");l=new Chart(s).Bar(r[u].data,h)}}this.CreateLinks();this.OnGetComplete(this)};this.CreateLinks=function(){$(this.Table).find("a").each(function(){var t=$(this),i,r,f,o,e,u,n;if(t.attr("href")==="#"&&(i=t.attr("data-action"),r=t.attr("data-controller"),typeof i=="undefined"&&(i=null),typeof r=="undefined"&&(r=null),f=t.attr("data-options"),typeof f=="undefined"&&(f="{}"),o=JSON.parse(f),i!==null&&r!==null)){for(e=window.location.origin+"/"+r+"/"+i+"?",u=Object.keys(o),n=0;n<u.length;n++)e+=u[n]+"="+o[u[n]],n!==u.length-1&&(e+="&");t.attr("href",e)}})};this.AddSorting=function(n){n.Order=this.Sortings.length+1;this.Sortings.push(n);this.Sorted=!1};this.ClearSortings=function(){this.Sortings=[];this.Sorted=!1};this.ClearFilters=function(){this.Filters=[];this.Filtered=!1};this.AddFilter=function(n){n.Order=this.Filters.length+1;this.Filters.push(n);this.Filtered=!1};this.Filter=function(){var h,n,e,o,s,u;for(this.FilteredRows=[],this.Filters.sort(function(n,t){return n.Order-t.Order}),h=0;h<this.Rows.length;h++){var i=!1,c=!0,t=[],l=this.Rows[h];for(n=0;n<this.Filters.length;n++){var r=this.Filters[n],f=!0,a=!0;c=r.GroupNext;e=!1;do{for(r.GroupNext||(c=!1),o=null,s=0;s<l.Columns.length;s++)if(l.Columns[s].HeaderId===r.ActingOn){o=l.Columns[s];break}o!==null&&(e=TestValue(o,r.Value.toLowerCase(),r.Test,FindHeader(this,o.HeaderId)));switch(r.Link){case"and":f=f&&e;break;case"or":f=a?e:f||e;break;default:f=e}if(a=!1,!c)break;if(n++,n<this.Filters.length)r=this.Filters[n];else break}while(c);t.push({test:f,link:n<this.Filters.length-1?this.Filters[n+1].Link:"none"})}for(i=t.length>0?t[0].test:!0,u=1;u<t.length;u++)switch(t[u-1].link){case"and":i=i&&t[u].test;break;case"or":i=i||t[u].test;break;default:i=t[u].test}i&&this.FilteredRows.push(l)}this.Filters.length===0&&(this.FilteredRows=this.Rows);this.Page=1;this.Filtered=!0;this.Sort();$('.jTable_totalRecords[data-jtable-target="'+this.Table+'"]').html(this.FilteredRows.length)};this.Sort=function(){var n,t;for(this.Filtered||this.Filter(),this.Sortings.length>0&&(this.Sortings.sort(function(n,t){return n.Order-t.Order}),n=this.Sortings,this.FilteredRows.sort(function(t,r){var u=0,h=0,c=FindHeader(i,n[u].ActingOn);if(c===null)return 1;var o=FindColumn(t,n[u].ActingOn),s=FindColumn(r,n[u].ActingOn),f=null,e=null;if(o!==null&&o.Value!==null&&(f=o.Value),s!==null&&s.Value!==null&&(e=s.Value),c.SortByPretty&&(f=o!=null?o.PrettyValue:null,e=s!=null?s.PrettyValue:null),f===null&&(f=""),e===null&&(e=""),h=c.Id==="confirmation"?advSorting.HexSort(f,e,n[u].Ascending):advSorting.NaturalSort(f,e,n[u].Ascending),h===0)for(u++;h===0;){if(u>=n.length)break;o=FindColumn(t,n[u].ActingOn);s=FindColumn(r,n[u].ActingOn);f=o.Value;e=s.Value;c.SortByPretty&&(f=o.PrettyValue,e=s.PrettyValue);f===null&&(f="");e===null&&(e="");h=c.Id==="confirmation"?advSorting.HexSort(f,e,n[u].Ascending):advSorting.NaturalSort(f,e,n[u].Ascending);u++}return h})),t=0;t<this.FilteredRows.length;t++)this.FilteredRows[t].Order=t+1;this.Sorted=!0};this.GetAverage=function(n,t){for(var c,p,e,l,w,h,it,b,et,k,a,y,o,rt,ct,ut=[],nt=new JTableRow,i=0;i<n.Headers.length;i++){if(n.Headers[i].Id==="email"){n.Headers[i].Hidden=!0;continue}else n.Headers[i].Hidden=!1;var r=new JTableColumn,tt=0,s=0,ft=!0,f={},u=[];for(c=0;c<n.Headers[i].PossibleValues.length;c++)f[n.Headers[i].PossibleValues[c].Label]=0,u.push({key:n.Headers[i].PossibleValues[c].Label,total:0});for(p=0;p<n.FilteredRows.length;p++)if(e=FindColumn(n.FilteredRows[p],n.Headers[i].Id),e!==null)switch(n.Headers[i].Type.root("=>")){case"itemParent":typeof f[e.PrettyValue]=="undefined"&&(f[e.PrettyValue]=0,u.push({key:e.PrettyValue,total:0}));f[e.PrettyValue]++;s++;break;case"multipleSelection":for(l=JSON.parse(e.Value),w=[],h=0;h<l.length;h++){for(it=!1,b=0;b<w.length;b++)if(w[b]===l[h]){it=!0;break}if(it)continue;else w.push(l[h]);for(et=l[h],k=null,a=0;a<n.Headers[i].PossibleValues.length;a++)n.Headers[i].PossibleValues[a].Id===et&&(k=n.Headers[i].PossibleValues[a]);k!==null&&f[k.Label]++}s++;break;case"boolean":e.Value==="1"?f.Yes++:f.No++;s++;break;case"number":case"rating":tt+=parseFloat(e.Value);s++;break;default:ft=!1}if(ft){r.HeaderId=n.Headers[i].Id;r.Id=n.Headers[i].Id;r.Value=tt/s;r.PrettyValue=r.Value;var d="",ot=[],st=[],ht=[],v=-1,g="<table><tbody>";switch(n.Headers[i].Type.root("=>")){case"multipleSelection":case"itemParent":case"boolean":for(y=0;y<u.length;y++)u[y].total=f[u[y].key];for(u.sort(function(n,t){return t.total-n.total}),o=0;o<u.length;o++)v++,rt=f[u[o].key]/s*100,v>4&&(v=0),ot.push({value:f[u[o].key],color:graphColors[v].color,highlight:graphColors[v].highlight,label:u[o].key}),ht.push(u[o].key),st.push(rt),g+='<tr><td style="text-align: right; padding-right: 3px; font-weight: bold;">'+u[o].key+":<\/td><td>"+rt.toFixed(2)+"%<\/td><\/tr>";g+="<\/tbody><\/table>";r.Value=g;d=g;n.Graph&&(n.Headers[i].Type==="multipleSelection"?(ct={labels:ht,datasets:[{label:"Selections",fillColor:"rgba(220,220,220,0.5)",strokeColor:"rgba(220,220,220,0.8)",highlightFill:"rgba(220,220,220,0.75)",highlightStroke:"rgba(220,220,220,1)",data:st}]},d='<div class="labeled-chart-container"><div class="canvas-holder"><canvas id="chart_'+r.Id+'" width="300" height="300"><\/canvas><\/div><div class="legend"><\/div><\/div>',t.push({id:"chart_"+r.Id,data:ct,type:"bar"})):(d='<div class="labeled-chart-container"><div class="canvas-holder"><canvas id="chart_'+r.Id+'" width="500" height="300"><\/canvas><\/div><div class="legend"><\/div><\/div>',t.push({id:"chart_"+r.Id,data:ot,type:"pie"})));r.PrettyValue=d;nt.Columns.push(r);break;case"number":case"rating":r.Value=Math.roundAdv(tt/s,2);r.PrettyValue=r.Value;nt.Columns.push(r);break;default:n.Headers[i].Hidden=!0}}else n.Headers[i].Hidden=!0}return ut.push(nt),ut};this.GetGraph=function(n,t){return this.GetAverage(n,t)};this.GetCount=function(n,t){for(var c,b,k,l,d,s,e,a,g,h,ft,nt,ht,tt,v,p,o,vt,et=[],ut=new JTableRow,i=0;i<n.Headers.length;i++){if(n.Headers[i].Id==="email"){n.Headers[i].Hidden=!0;continue}else n.Headers[i].Hidden=!1;var u=new JTableColumn,ot=0,w=0,st=!0,f={},r=[];for(c=0;c<n.Headers[i].PossibleValues.length;c++)f[n.Headers[i].PossibleValues[c].Label]=0,r.push({key:n.Headers[i].PossibleValues[c].Label,total:0});if(n.Headers[i].Type.root("=>")==="rating")for(b=n.Headers[i].Type,b=b.split("=>")[1],k=JSON.parse(b),l=k.min;l<k.max;l+=k.step)f[l.toString()]=0,r.push({key:l.toString(),total:0});for(d=0;d<n.FilteredRows.length;d++)if(s=FindColumn(n.FilteredRows[d],n.Headers[i].Id),s!==null)switch(n.Headers[i].Type.root("=>")){case"itemParent":case"rating":e=s.PrettyValue;e=e.replace(/(<[^>]*>[^<]*<[^>]*>)/g,"");e=e.trim();typeof f[e]=="undefined"&&(f[e]=0,r.push({key:e,total:0}));f[e]++;w++;break;case"multipleSelection":for(a=JSON.parse(s.Value),g=[],h=0;h<a.length;h++){for(ft=!1,nt=0;nt<g.length;nt++)if(g[nt]===a[h]){ft=!0;break}if(ft)continue;else g.push(a[h]);for(ht=a[h],tt=null,v=0;v<n.Headers[i].PossibleValues.length;v++)n.Headers[i].PossibleValues[v].Id===ht&&(tt=n.Headers[i].PossibleValues[v]);tt!==null&&f[tt.Label]++}w++;break;case"boolean":s.Value==="1"?f.Yes++:f.No++;w++;break;case"number":ot+=parseFloat(s.Value);w++;break;default:st=!1}if(st){u.HeaderId=n.Headers[i].Id;u.Id=n.Headers[i].Id;u.Value=ot;u.PrettyValue=u.Value;var it="",ct=[],lt=[],at=[],y=-1,rt="<table><tbody>";switch(n.Headers[i].Type.root("=>")){case"multipleSelection":case"itemParent":case"rating":case"boolean":for(p=0;p<r.length;p++)r[p].total=f[r[p].key];for(n.Headers[i].Type.root("=>")!=="rating"&&r.sort(function(n,t){return t.total-n.total}),o=0;o<r.length;o++)y++,y>4&&(y=0),ct.push({value:f[r[o].key],color:graphColors[y].color,highlight:graphColors[y].highlight,label:r[o].key}),at.push(r[o].key),lt.push(f[r[o].key]),rt+='<tr><td style="text-align: right; padding-right: 3px; font-weight: bold;">'+r[o].key+":<\/td><td>"+f[r[o].key]+"<\/td><\/tr>";rt+="<\/tbody><\/table>";u.Value=rt;it=rt;n.Graph&&(n.Headers[i].Type==="multipleSelection"?(vt={labels:at,datasets:[{label:"Selections",fillColor:"rgba(220,220,220,0.5)",strokeColor:"rgba(220,220,220,0.8)",highlightFill:"rgba(220,220,220,0.75)",highlightStroke:"rgba(220,220,220,1)",data:lt}]},it='<div class="labeled-chart-container"><div class="canvas-holder"><canvas id="chart_'+u.Id+'" width="300" height="300"><\/canvas><\/div><div class="legend"><\/div><\/div>',t.push({id:"chart_"+u.Id,data:vt,type:"bar"})):(it='<div class="labeled-chart-container"><div class="canvas-holder"><canvas id="chart_'+u.Id+'" width="500" height="300"><\/canvas><\/div><div class="legend"><\/div><\/div>',t.push({id:"chart_"+u.Id,data:ct,type:"pie"})));u.PrettyValue=it;ut.Columns.push(u);break;case"number":ut.Columns.push(u);break;default:n.Headers[i].Hidden=!0}}else n.Headers[i].Hidden=!0}return et.push(ut),et};this.GetNormal=function(n,t){for(var r=[],u=0,i=t;i<n.FilteredRows.length;i++)if(r.push(n.FilteredRows[i]),u++,u>=n.RecordsPerPage)break;return r};this.UpdateRow=function(n,t,i){var r,o,u,f,e;if((!(n.Average||n.Graph||n.Count)||!n.Headers[u].Hidden)&&(r=$("#"+t.Id),r.length!==0)){for(typeof i!="boolean"&&(i=!1),(this.Options.type==="email"||this.Options.type==="invitation")&&(i=!0),o=r.css("background-color"),i||r.css("background-color","rgba(122,2,2,.5)"),u=0;u<n.Headers.length;u++)(f=r.find('td[data-headerid="'+n.Headers[u].Id+'"]'),f.length!==0)&&(e=FindColumn(t,n.Headers[u].Id),typeof e!="undefined"&&e!==null?f.html(e.PrettyValue):f.html(""));this.CreateLinks();this.OnUpdateComplete(r);i||setTimeout(function(){r.animate({backgroundColor:o},1e3,function(){r.css("background-color","")})},5e3)}};this.OnUpdateComplete=function(){};this.GenerateTableHtml=function(n,t){var r,u,f,h,i,o,s,e;for($('.jTable_parentName[data-jtable-target="'+this.Table+'"]').html(this.Parent),$('.jTable_name[data-jtable-target="'+this.Table+'"]').html(this.Name),r="<thead><tr>",u=0;u<n.Headers.length;u++)(n.Average||n.Graph||n.Count)&&n.Headers[u].Hidden||n.Headers[u].Removed||(f=n.Headers[u].Group,f=typeof f!="undefined"&&f!==null&&f!==""?"<i>"+f+"<\/i><br />":"",r+='<th class="" data-header-id="'+n.Headers[u].Id+'">'+f+n.Headers[u].Label+"<\/th>");for(r+="<\/tr><\/thead><tbody>",h=0;h<t.length;h++){for(r+='<tr id="'+t[h].Id+'">',i=0;i<n.Headers.length;i++)(n.Average||n.Graph||n.Count)&&n.Headers[i].Hidden||n.Headers[i].Removed||(o=n.Headers[i].Editable,(n.Average||n.Graph||n.Count)&&(o=!1),s=FindColumn(t[h],n.Headers[i].Id),typeof s!="undefined"&&s!==null?(o=o||s.Editable,e=s.PrettyValue,!this.Graph&&!this.Count&&!this.Average&&e!==null&&e.indexOf("<a")===-1&&e.length>100&&(e=e.substr(0,100)+"..."),r+='<td data-headerid="'+n.Headers[i].Id+'" id="'+s.Id+'" class="'+(o?"editable-item cursor-pointer":"")+'">'+e+"<\/td>"):r+='<td data-headerid="'+n.Headers[i].Id+'" class="'+(o?"editable-item cursor-pointer":"")+'"><\/td>');r+="<\/tr>"}return r+"<\/tbody>"};this.GetPrintView=function(n){var i,r,t,u;if(this.Filtered||this.Filter(),this.Sorted||this.Sort(),i=[],this.Count)i=this.GetCount(this,n);else if(this.Average)i=this.GetAverage(this,n);else if(this.Graph)i=this.GetGraph(this,n);else for(r=0;r<this.FilteredRows.length;r++)i.push(this.FilteredRows[r]);return t='<html><head><title>"'+this.Name+'"<\/title><script src="'+window.location.origin+'/Scripts/jquery-2.1.3.min.js"><\/script><script src="'+window.location.origin+'/Scripts/Chartv2.js"><\/script><link href="'+window.location.origin+'/Content/Bootstrap/bootstrap.min.css" rel="stylesheet" />',t+="<style> ",t+=".body { color: #3e3e3e; } ",t+=".report-header { position: fixed; left: 0; top: 0; width: 100%; height: 100px; overflow: hidden; padding: 10px 10px 0 10px; background: white; } ",t+="img.img-report-header { display: block; width: 100%; max-width: 250px; max-height: 75px; } ",t+=".report-title { text-align: right; } ",t+=".report-content { padding-top: 100px; } ",t+="table.table-full-page > thead > tr { border-top: 1px solid #ddd; } ",t+="table.table-full-page > thead > tr > th { padding-right: 50px !important; white-space: nowrap; min-width: 150px; background: white; font-size: 12px; } ",t+="table.table-full-page > tbody > tr { height: 75px; font-size: 12px; } ",t+="table.table-full-page > tbody > tr:last-child { border-bottom: 1px solid #ddd; } ",t+="table.table-full-page > tbody > tr:nth-child(even) > td { background: white; } ",t+="table.table-full-page td { padding: 0 0 0 0 !important; } ",t+=".cell-height { height: 75px; padding: 5px; overflow-y: auto; } ",t+="@media screen and (max-width: 1199px) { .report-header { position: relative; height: auto; overflow: visible; } ",t+=".report-title { text-align: left; padding-top: 15px; } ",t+=".report-content { padding-top: 15px; } ",t+="table.table-full-page > tbody > tr { height: auto; font-size: 12px; } ",t+=".cell-height { height: auto; max-height: 50px; padding: 5px; overflow-y: auto; } } ",t+="<\/style>",t+="<\/head><body>",t+='<div class="report-header"><div class="row"><div class="col-lg-3"><img class="img-report-header" src="https://toolkit.regstep.com/Images/Common/regstep.png"/><\/div>',t+='<div class="col-lg-9 report-title">'+(typeof this.Parent!="undefined"&&this.Parent!==null&&this.Parent!==""?"<h3>"+this.Parent+"<\/h3>":"")+"<h4>"+this.Name+"<\/h4>"+(typeof this.Description!="undefined"&&this.Description!==null&&this.Description!==""?"<h5>"+this.Description+"<\/h5>":"")+'<\/div><\/div><\/div><div class="report-content">',t+='<table class="table table-striped table-full-page">',t+=this.GenerateTableHtml(this,i),t+='<\/table><script type="text/javascript">\r\n',t+="//Render Charts\r\nChart.defaults.global.animation = false;\r\nchartData = "+JSON.stringify(n)+"\r\nfor (var i = 0; i < chartData.length; i++) {\r\n"+'    var template = "<ul class=\\"<%=name.toLowerCase()%>-legend\\"><% for (var i=0; i<segments.length; i++){%><li><span style=\\"background-color:<%=segments[i].fillColor%>\\"><\/span><%if(segments[i].label){%><b><%=segments[i].label%><\/b>: <%=+(Math.round(((segments[i].value / total) * 100) + \'e+2\')  + \'e-2\')%>%<%}%><\/li><%}%><\/ul>";\r\n'+"    if (this.Count) {\r\n"+'        var template = "<ul class=\\"<%=name.toLowerCase()%>-legend\\"><% for (var i=0; i<segments.length; i++){%><li><span style=\\"background-color:<%=segments[i].fillColor%>\\"><\/span><%if(segments[i].label){%><b><%=segments[i].label%><\/b>: <%=segments[i].value%><%}%><\/li><%}%><\/ul>";\r\n'+"    }\r\n    switch (chartData[i].type) {\r\n        case 'pie':\r\n            var ctx = $('#' + chartData[i].id).get(0).getContext('2d');\r\n            var chart = new Chart(ctx).Pie(chartData[i].data, {\r\n                legendTemplate: template\r\n            });\r\n            var legend = chart.generateLegend();\r\n            $('#' + chartData[i].id).parent().parent().children('.legend').html(legend);\r\n            break;\r\n        case 'bar':\r\n            var step = 10;\r\n            var max = 100;\r\n            var start = 100;\r\n            var options = {};\r\n            var data = chartData[i].data;\r\n            if (this.Count) {\r\n                for (var j = 0; j < data.datasets[0].data.length; j++) {\r\n                    if (max < data.datasets[0].data[j]) {\r\n                        max = data.datasets[0].data[j];\r\n                    }\r\n                    if (start > data.datasets[0].data[j]) {\r\n                        start = data.datasets[0].data[j];\r\n                    }\r\n                }\r\n                start = (start - 10) - (start % 10);\r\n                if (start < 0) {\r\n                    start = 0;\r\n                }\r\n            } else {\r\n                start = 0;\r\n            }\r\n            options.scaleOverride = true;\r\n            options.scaleSteps = Math.ceil((max - start) / step);\r\n            options.scaleStepWidth = step;\r\n            options.scaleStartValue = start;\r\n            var ctx = $('#' + chartData[i].id).get(0).getContext('2d');\r\n            var chart = new Chart(ctx).Bar(chartData[i].data, options);\r\n            break;\r\n    }\r\n}\r\nsetInterval(function () { window.print(); }, 500);",t+="<\/script><\/body><\/html>",u=window.open("about:blank","","_blank"),u.document.write(t),t};this.Load=function(n,t){var f,u,r;t===null&&(t={});f="jTable: ";u="";typeof t.id!="undefined"&&t.id!==null&&(u+="?id="+t.id,f+=t.id);typeof t.type!="undefined"&&t.type!==null&&t.type!==""&&(u+="&type="+t.type,f+="_"+t.type);r=new XMLHttpRequest;r.addEventListener("progress",this.UpdateProgress,!1);n+=u;r.open("get",n,!0);RESTFUL.ajaxHeader(r);r.onload=function(n){var u=n.currentTarget,r,t;u.status===200?(r=RESTFUL.parse(u),t=r.Table,r.Success?(i.Filters=t.Filters,i.Sortings=t.Sortings,i.Rows=t.Rows,i.Count=t.Count,i.Graph=t.Graph,i.Average=t.Average,i.Description=t.Description,i.Name=t.Name,i.Parent=t.Parent,i.Favorite=t.Favorite,i.Headers=t.Headers,i.Id=t.Id,i.Options=t.Options,i.Page=1,i.RecordsPerPage=t.RecordsPerPage,i.TotalRecords=t.TotalRecords,i.SavedId=t.SavedId,i.LastFullCheck=moment(),i.UpdateView(i),i.AfterLoad(i),i.Filter(),i.GetPage(),i.SavedId!==null?$(".jTable_standardOnly").hide():$(".jTable_standardOnly").show()):RESTFUL.showError("Failed to load data.","Unhandled Exception")):RESTFUL.showError("Failed to load data.","Unhandled Exception");prettyProcessing.hidePleaseWait()};r.onerror=function(){RESTFUL.showError();prettyProcessing.hidePleaseWait()};prettyProcessing.showPleaseWait("Requesting Data","Requesting data from the server.");r.send()};this.UpdateProgress=function(n){if(n.lengthComputable){var t=n.loaded/n.total*100;prettyProcessing.update("Downloading Data","Downloading the data from the server.",t)}else prettyProcessing.update("Downloading Data","Downloading the data from the server.",100)};this.AfterLoad=function(n){typeof BREADCRUMB_VERSION!="undefined"&&BREADCRUMB_CURRENT!==null&&(BREADCRUMB_CURRENT.Label=n.Name+" on "+n.Parent,UpdateCrumb(BREADCRUMB_CURRENT))};this.UpdateView=function(){$('.jTable_parentName[data-jtable-target="'+this.Table+'"]').html(this.Parent);$('.jTable_name[data-jtable-target="'+this.Table+'"]').html(this.Name);$('.jTable_recordsPerPage[data-jtable-target="'+this.Table+'"]').val(this.RecordsPerPage);$('.jTable_pageSelect[data-jtable-target="'+this.Table+'"]').html("");this.Filter();this.Sort();for(var n=0;n<this.TotalPages();n++)$('.jTable_pageSelect[data-jtable-target="'+this.Table+'"]').append('<option value="'+(n+1)+'" '+(this.Page===n+1?'selected="selected"':"")+">"+(n+1)+"<\/option>");$('.jTable_pageSelect[data-jtable-target="'+this.Table+'"] > option').prop("selected",!1);$('.jTable_pageSelect[data-jtable-target="'+this.Table+'"] > option[value="'+this.Page+'"]').prop("selected",!0);this.SavedId===null||this.SavedId===""||typeof this.SavedId=="undefined"?$('.jTable_standarOnly[data-jtable-target="'+this.Table+'"]').show():$('.jTable_standardOnly[data-jtable-target="'+this.Table+'"]').hide();this.Favorite?$('.jTable_favorite[data-jtable-target="'+this.Table+'"]').html('<span class="glyphicon glyphicon-star glyphicon-small"><\/span> Un-Favorite'):$('.jTable_favorite[data-jtable-target="'+this.Table+'"]').html('<span class="glyphicon glyphicon-star-empty glyphicon-small"><\/span> Favorite');this.SortingObject.Generate();this.FilterObject.Generate()};this.GetAjaxData=function(){var n={};return n.FilteredRows=[],n.Rows=[],n.Filters=this.Filters,n.Sortings=this.Sortings,n.Id=this.Id,n.SavedId=this.SavedId,n.Count=this.Count,n.Graph=this.Graph,n.Average=this.Average,n.Name=this.Name,n.Description=this.Description,n.Options=this.Options,n.Headers=this.Headers,n.Favorite=this.Favorite,n.Parent=this.Parent,n}}function JTableSorting(){"use strict";this.ActingOn="";this.Ascending=!0;this.Order=1}function JTableFilter(){"use strict";this.ActingOn="";this.Test="==";this.Value="";this.Order=1;this.Link=null;this.GroupNext=!1;this.CaseSensitive=!1}function JTableHeader(){"use strict";this.Label="";this.Id="";this.Order=1;this.Hidden=!1;this.Group="";this.Type="text";this.PossibleValues=[];this.Editable=!1;this.Removed=!1;this.SortByPretty=!1}function JTableHeaderPossibleValue(){"use strict";this.Id="";this.Label=""}function JTableRow(){"use strict";this.Id="";this.Columns=[];this.Order=1;this.PreviousSort=0}function JTableColumn(){"use strict";this.HeaderId="";this.PrettyValue="";this.Id="";this.Value="";this.Editable=!0}function TestValue(n,t,i,r){"use strict";var e=r.Type,u="",o=!1,a,v,s,h,c,l,f;if(n.Value===null&&(n.Value=""),t===null&&(t=""),e==="string"||e==="text")switch(i){case"==":return n.Value.toLowerCase()===t.toLowerCase();case"!=":return n.Value.toLowerCase()!==t.toLowerCase();case">":return n.Value.length>parseInt(t);case">=":return n.Value.length>=parseInt(t);case"<":return n.Value.lenth<parseInt(t);case"<=":return n.Value.length<=parseInt(t);case"*=":return n.Value.toLowerCase().indexOf(t)!==-1;case"!*=":return n.Value.toLowerCase().indexOf(t)===-1;case"^=":return n.Value.toLowerCase().indexOf(t)===0;case"!^=":return n.Value.toLowerCase().indexOf(t)!==0;case"$=":return n.Value.toLowerCase().indexOf(t,n.Value.length-t.length)!==-1;case"!$=":return n.Value.toLowerCase().indexOf(t,n.Value.length-t.length)===-1;case"=rgx=":return a=new RegExp(t,"i"),a.test(n.Value);case"!=rgx=":return v=new RegExp(t,"i"),!v.test(n.Value)}else if(e==="number"||e.indexOf("rating")===0){u=parseFloat(n.Value);s=parseFloat(t);switch(i){case"==":return u===s;case"!=":return u!==s;case">":return u>s;case">=":return u>=s;case"<":return u<s;case"<=":return u<=s}}else if(e==="multipleSelection"){u=JSON.parse(n.Value);o=!1;switch(i){case"==":return u.length===1&&u[0]===t;case"!=":for(h=0;h<u.length;h++)if(u[h]===t){o=!0;break}return!o;case"in":for(c=0;c<u.length;c++)if(u[c]===t){o=!0;break}return o;case"notin":for(l=0;l<u.length;l++)if(u[l]===t){o=!0;break}return!o}}else if(e==="itemParent"){o=!1;switch(i){case"==":return n.Value===t;case"!=":return n.Value!==t}}else if(e==="date"){u=moment(n.Value);f=moment(t);switch(i){case"==":return u.isSame(f);case"!=":return!u.isSame(f);case">":return u.isAfter(f);case">=":return u.isSame(f)||u.isAfter(f);case"<":return u.isBefore(f);case"<=":return u.isSame(f)||u.isBefore(f)}}else if(e==="boolean")switch(i){case"==":return n.Value===t;case"!=":return n.Value!==t}return!1}function ReplaceRow(n,t){"use strict";for(var i=0;i<n.Rows.length;i++)if(n.Rows[i].Id===t.Id)return n.Rows[i]=t,!0;return n.Rows.push(t),!1}function ReplaceHeader(n,t){"use strict";for(var i=0;i<n.Headers.length;i++)if(n.Headers[i].Id===t.Id){n.Headers[i]=t;return}n.Headers.push(t)}function FindColumn(n,t){"use strict";for(var i=0;i<n.Columns.length;i++)if(n.Columns[i].HeaderId===t)return n.Columns[i];return null}function FindRow(n,t){"use strict";for(var i=0;i<n.Rows.length;i++)if(n.Rows[i].Id===t)return n.Rows[i];return null}function FindHeader(n,t){"use strict";for(var i=0;i<n.Headers.length;i++)if(n.Headers[i].Id===t)return n.Headers[i];return null}function GenerateHeaderDiv(n,t){"use strict";var r=$(window).innerHeight(),i;return r*=.72,i='<div class="modal fade" id="'+n+'" data-jtable-target="'+t+'"><div class="modal-dialog modal-fill"><div class="modal-header"><h3 class="modal-title">Report Fields<\/h3><\/div>',i+='<div class="modal-body" style="max-height: '+r+'px;"><div class="row"><div class="col-md-5 header-selection-window"><div class="headers-container headers-available"><div class="headers-title">Available Fields<\/div><div class="headers-container-available"><\/div><\/div><\/div>',i+='<div class="col-md-2 header-selection-buttons"><div class="headers-commands"><a href="#" class="add-header">Add <span class="glyphicon glyphicon-chevron-right glyphicon-small"><\/span><\/a><br /><br /><a href="#" class="remove-header"><span class="glyphicon glyphicon-chevron-left glyphicon-small"><\/span><\/span> Remove<\/a><\/div><\/div>',i+='<div class="col-md-5 header-selection-window"><div class="headers-container headers-selected"><div class="headers-title">Included Fields<\/div><div class="headers-container-selected"><\/div><\/div><\/div>',i+="<\/div><\/div>",i+'<div class="modal-footer"><button type="button" class="btn btn-default headers-set">Set<\/button><\/div><\/div><\/div>'}var JTables={},graphColors,JTestString,JLinkString;JTables.Version=new Version(1,3,1,0);JTables.tableIndex=-1;Chart.defaults.global.responsive=!0;graphColors=[{color:"#8B2323",highlight:"#D04545"},{color:"#00688B",highlight:"#00BEFE"},{color:"#006400",highlight:"#008000"},{color:"#FBEC5D",highlight:"#FCF18B"},{color:"#2E0854",highlight:"#6F13CB"}];String.prototype.root||(String.prototype.root=function(n){"use strict";var t=this.indexOf(n);return t===-1?this:this.substring(0,t)});Math.roundAdv||(Math.roundAdv=function(n,t){"use strict";return isNaN(n)?0:+(Math.round(n+"e+"+t)+"e-"+t)});JTestString=["==",">",">=","<","<=","!=","^=","!^=","$=","!$=","*=","!*=","=rgx=","!=rgx=","in","notIn"];JLinkString=["none","and","or"];
//# sourceMappingURL=jTable.min.js.map
