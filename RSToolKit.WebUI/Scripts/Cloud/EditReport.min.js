function SaveNewHeader(){SavedSprite("#cloudSave");header.Name=$("#newHeaderLabel").val();$("#name").val("");$.ajax({url:"../RSCloud/AddHeader",type:"post",data:header,dataType:"json",traditional:"true",success:function(n){n.Success?(SavedSprite("#cloudSave"),report.ModificationToken=n.ModificationToken,$("#reportHeaders > tr").append('<th class="report-header report-table-header-editable report-header" data-id="'+header.UId+'">'+header.Name+"<\/th>"),$(".report-table-body > tr").each(function(){$(this).append('<td class="report-table-header-editable table-header-empty" data-report-header-uid="'+n.Header.UId+'"><\/td>')}),report.Headers.push(n.Header),ClickHeaders()):(SaveError("#cloudSave"),$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">'+n.Message+"<\/div><\/div>"),$("#informationModal").modal("show"))},error:function(){SaveError("#cloudSave");$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">Internal Server Error<\/div><\/div>');$("#informationModal").modal("show")}})}function SaveReportName(n){report.Name!=n&&(SaveSprite("#cloudSave"),$.ajax({url:"../RSCloud/UpdateReportName",type:"post",data:{Company:CurrentCompany,UId:ReportId,Name:n},dataType:"json",traditional:"true",success:function(n){n.Success?(SavedSprite("#cloudSave"),report.ModificationToken=n.ModificationToken,report.Name=$("#name").val(),$("#name").trigger("change")):(SaveError("#cloudSave"),$(this).val(report.Name),$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">'+n.Message+"<\/div><\/div>"),$("#informationModal").modal("show"))},error:function(){SaveError("#cloudSave");$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">Internal Server Error<\/div><\/div>');$("#informationModal").modal("show")}}))}function SaveNewTable(){SaveSprite("#cloudSave");var n=$("#tables").val();$("#name").val("");$.ajax({url:"../RSCloud/AddTable",type:"post",data:{tableUId:n,cid:CurrentCompany,rid:ReportId},dataType:"json",traditional:"true",success:function(n){var t,i;if(n.Success){for(SavedSprite("#cloudSave"),report.ModificationToken=n.ModificationToken,report.Tables.push(n.Table),$("#mainHolder .report-work-area").append('<div class="report-table" data-table-uid="'+n.Table.UId+'">'+n.Table.Name+"<\/div>"),t='<tr data-table-sql-uid="'+n.Table.TableUId+'" data-table-uid="'+n.Table.UId+'"><td class="report-form">'+n.Table.Name+'<input type="hidden" id="filtersData" /><span class="psuedo-link table-filter text-rsred"><span class="glyphicon glyphicon-filter"><\/span><\/span><\/td>',i=0;i<report.Headers.length;i++)t+='<td data-report-header-uid="'+report.Headers[i].UId+'" data-table-header-uid="" class="report-table-header-editable table-header table-header-empty"><\/td>';t+="<\/tr>";$(".report-table-body").append(t);OrderTablesLeft();ClickHeaders();GetAvailableTables()}else SaveError("#cloudSave"),$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">'+n.Message+"<\/div><\/div>"),$("#informationModal").modal("show")},error:function(){SaveError("#cloudSave");$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">Internal Server Error<\/div><\/div>');$("#informationModal").modal("show")}})}function SaveSprite(n){var t=$(n);$(t).modal("show");t.find(".saved-sprite").removeClass("saved-sprite")}function SavedSprite(n){var t=$(n);t.find(".save-sprite").addClass("saved-sprite");setTimeout(function(){t.modal("hide");setTimeout(function(){t.find(".saved-sprite").removeClass("saved-sprite")},5e3)},800)}function SaveError(n){var t=$(n);t.find(".save-sprite").addClass("error-sprite");setTimeout(function(){t.modal("hide");setTimeout(function(){t.find(".error-sprite").removeClass("error-sprite")},5e3)},2e3)}function StartDrag(){$(".report-table, .report-work-area").off();$(".report-table").on("mousedown",function(n){tableDrag=!0;startX=n.pageX-$(".report-work-area").offset().left;startY=n.pageY-$(".report-work-area").offset().top;cursorOffsetX=n.pageX-$(this).offset().left;cursorOffsetY=n.pageY-$(this).offset().top;tableDragging=this});$(".report-work-area").on("mousemove",function(n){if(tableDrag){var t=n.pageX-$(".report-work-area").offset().left,i=n.pageY-$(".report-work-area").offset().top,r=n.pageX-$(".report-work-area").offset().left-cursorOffsetX,u=n.pageY-$(".report-work-area").offset().top-cursorOffsetY,f=Math.abs(Math.sqrt(Math.pow(startX-t,2)+Math.pow(startY-i,2)));f>20&&$(tableDragging).css("top",u).css("left",r)}});$(".report-work-area").on("mouseup",function(){tableDrag=!1;tableDragging=null})}function GetModificationToken(){$.ajax({url:"../RSCloud/GetModificationToken",type:"post",data:{cid:CurrentCompany,id:ReportId},dataType:"json",traditional:"true",success:function(n){n.ModificationToken!=report.ModificationToken&&($("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">The report was edited by someone else.<\/div><\/div>'),$("#informationModal").modal("show"))}});setTimeout(function(){GetModificationToken()},2e4)}function GetAvailableTables(){$.ajax({url:"../RSCloud/GetReportTablesAvailable",type:"post",data:{cid:CurrentCompany},dataType:"json",traditional:"true",success:function(n){n.Success?(availableTables=n.Tables,SetTables()):($("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">'+n.Message+"<\/div><\/div>"),$("#informationModal").modal("show"))},error:function(){$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">Internal Server Error<\/div><\/div>');$("#informationModal").modal("show")}})}function SetTables(){var t,n;if($("#tables").html(""),report.ReportType==0)for(n=0;n<availableTables.length;n++)for(t=0;t<report.Tables.length;t++)if(availableTables[n].UId==report.Tables[t].TableUId){availableTables.splice(n,1);n--;break}for(n=0;n<availableTables.length;n++)$("#tables").append('<option value="'+availableTables[n].UId+'">'+availableTables[n].Name+"<\/option>")}function OrderTablesLeft(){$("#sqlHeaderInfo").remove();$(".report-table").each(function(n){var t=20*n+20;$(this).animate({top:t+"px",left:"20px",width:"auto"});$(this).css("z-index","")})}function ClickHeaders(){$(".table-header").off();$(".report-header").off();$(".report-form").off();$(".table-filter").off();$(".table-filter").on("click",function(){var i=$(this).parents("tr").attr("data-table-uid"),r=$(this).parents("tr").attr("data-table-sql-uid"),n,t;for(filterTable=r,n=-1,t=0;report.Tables.length;t++)if(report.Tables[t].UId==i){n=t;break}$.ajax({url:"../FormBuilder/GetFormVariables",type:"post",data:{cids:CurrentCompany,fids:r},dataType:"json",traditional:"true",success:function(t){var r;for(filters=[],t.id.push("Confirmation"),t.variable.push("Confirmation"),t.id.push("Audience"),t.variable.push("Audience"),t.id.push("Status"),t.variable.push("Status"),t.id.push("Type"),t.variable.push("Type"),r=0;r<t.id.length;r++)t.variable[r].toLowerCase()=="email"&&(t.id[r]="Email"),filters.push({UId:t.id[r],Name:t.variable[r]});while(currentFilters.length>0)currentFilters.pop();for(r=0;r<report.Tables[n].Filters.length;r++)currentFilters.push(report.Tables[n].Filters[r]);SetUpFilters(report.Tables[n].TableUId);$("#filterModal").modal("show");$("#filterNow").off().on("click",function(){report.Tables[n].Filters=[];for(var t=0;currentFilters.length>t;t++)report.Tables[n].Filters.push(currentFilters[t]);SaveTableFilter(i)})},error:function(){$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">Internal Server Error<\/div><\/div>');$("#informationModal").modal("show")}})});$(".report-form").on("contextmenu",function(n){$(".context-menu").hide();tableContext.UId=$(this).parent().attr("data-table-uid");var t=n.pageY,i=n.pageX;return $("#contextMenuForm").css({top:t,left:i}),$("#contextMenuForm").show(),n.preventDefault(),!1});$(".report-header").on("contextmenu",function(n){$(".context-menu").hide();headerContext.UId=$(this).attr("data-id");var t=n.pageY,i=n.pageX;return $("#contextMenuHeader").css({top:t,left:i}),$("#contextMenuHeader").show(),n.preventDefault(),!1});$(".table-header").on("contextmenu",function(n){$(".context-menu").hide();headerContext.UId=$(this).attr("data-table-header-uid");tableContext.UId=$(this).parent().attr("data-table-uid");var t=n.pageY,i=n.pageX;return $("#contextMenuTableHeader").css({top:t,left:i}),$("#contextMenuTableHeader").show(),n.preventDefault(),!1});$(".table-header").on("click",function(){var u,n,h,t;$("#sqlHeaderInfo").remove();var f=$(this),o=f.parent().attr("data-table-uid"),c=f.parent().attr("data-table-sql-uid"),e=f.attr("data-report-header-uid"),i=$('.report-table[data-table-uid="'+o+'"]'),r=-1,l=-1,s=f.hasClass("table-header-empty"),a="";if(i!=null){for(u={Id:-1,SqlTableUId:o,ReportHeaderUId:e,Filters:[],SqlHeaderUId:c,UId:"00000000-0000-0000-0000-000000000000",Company:CurrentCompany,Name:"New Header",DateCreated:null,DateModified:null,Owner:"00000000-0000-0000-0000-000000000000",Group:"00000000-0000-0000-0000-000000000000",Permission:"755",Type:"SqlHeader",ModificationToken:"00000000-0000-0000-0000-000000000000",ModifiedBy:"00000000-0000-0000-0000-000000000000"},n=0;n<report.Tables.length;n++)if(report.Tables[n].UId==o){for(r=n,t=0;t<report.Tables[n].Headers.length;t++)if(report.Tables[n].Headers[t].ReportHeaderUId==e){u=report.Tables[n].Headers[t];l=t;break}break}for(n=0;n<report.Headers.length;n++)report.Headers[n].UId==u.ReportHeaderUId&&(a=report.Headers[n].Name.replace(" ","").toLowerCase());for(OrderTablesLeft(),i.stop(),i.animate({width:"800px",left:"200px",top:"30px"},500),i.css("z-index","30"),i.append(sqlHeaderHtml),$.ajax({url:"../FormBuilder/GetFormVariables",type:"post",data:{cids:CurrentCompany,fids:c},dataType:"json",traditional:"true",success:function(n){var i,t;for(filters=[],n.id.push("Confirmation"),n.variable.push("Confirmation"),n.id.push("Audience"),n.variable.push("Audience"),n.id.push("Status"),n.variable.push("Status"),n.id.push("Type"),n.variable.push("Type"),i="",t=0;t<n.id.length;t++)s&&a==n.variable[t].toLowerCase()&&(i=n.id[t]),$("#formVariable").append('<option value="'+n.id[t]+'" data-name="'+n.variable[t]+'">'+n.variable[t]+"<\/option>"),n.variable[t].toLowerCase()=="email"&&(n.id[t]="Email"),filters.push({UId:n.id[t],Name:n.variable[t]});s?$("#formVariable").val(i):$("#formVariable").val(u.SqlHeaderUId)},error:function(){$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">Internal Server Error<\/div><\/div>');$("#informationModal").modal("show")}}),n=0;n<report.Headers.length;n++){for(h=!1,t=0;t<report.Tables[r].Headers.length;t++)if(report.Tables[r].Headers[t].ReportHeaderUId==report.Headers[n].UId){h=!0;break}h&&report.Tables[r].Headers[t].ReportHeaderUId!=e||$("#reportHeader").append('<option value="'+report.Headers[n].UId+'" data-name="'+report.Headers[n].Name+'">'+report.Headers[n].Name+"<\/option>")}$("#reportHeader").val(e);$("#btnDataSave").on("click",function(){SaveHeader(u,r,l,s)})}})}function SaveHeader(n,t,i,r){SaveSprite("#cloudSave");var u="UpdateSqlHeader";r&&(u="AddSqlHeader");n.SqlHeaderUId=$("#formVariable").val();n.ReportHeaderUId=$("#reportHeader").val();n.Name=$('#formVariable option[value="'+n.SqlHeaderUId+'"]').text();$.ajax({url:"../RSCloud/"+u,type:"post",data:JSON.stringify(n),dataType:"json",traditional:"true",contentType:"application/json; charset=utf-8",success:function(n){if(n.Success){if(report.ModificationToken=n.ModificationToken,modifiedCode=n.ModificationToken,SavedSprite("#cloudSave"),t==-1)return;i==-1?report.Tables[t].Headers.push(n.SqlHeader):report.Tables[t].Headers[i]=n.SqlHeader;$('tr[data-table-uid="'+n.SqlHeader.SqlTableUId+'"]').find('td[data-report-header-uid="'+n.SqlHeader.ReportHeaderUId+'"]').html(n.SqlHeader.Name);r&&$('tr[data-table-uid="'+n.SqlHeader.SqlTableUId+'"]').find('td[data-report-header-uid="'+n.SqlHeader.ReportHeaderUId+'"]').removeClass("table-header-empty").attr("data-table-header-uid",n.SqlHeader.UId)}else SaveError("#cloudSave"),$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">'+n.Message+"<\/div><\/div>"),$("#informationModal").modal("show")},error:function(){SaveError("#cloudSave");$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">Internal Server Error<\/div><\/div>');$("#informationModal").modal("show")}})}function SaveTableFilter(n){for(var i=-1,t=0;t<report.Tables.length;t++)if(report.Tables[t].UId==n){i=t;break}i!=-1&&(SaveSprite("#cloudSave"),$.ajax({url:"../RSCloud/UpdateSqlTableFilters",type:"post",data:JSON.stringify({Company:CurrentCompany,SqlTable:n,Filters:report.Tables[i].Filters}),dataType:"json",traditional:"true",contentType:"application/json; charset=utf-8",success:function(n){n.Success?SavedSprite("#cloudSave"):(SaveError("#cloudSave"),$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">'+n.Message+"<\/div><\/div>"),$("#informationModal").modal("show"))},error:function(){SaveError("#cloudSave");$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">Internal Server Error<\/div><\/div>');$("#informationModal").modal("show")}}))}function PreviewTable(){SaveSprite("#cloudSave");$.ajax({url:"../RSCloud/GetReportData",type:"post",data:JSON.stringify({company:CurrentCompany,report:ReportId}),dataType:"json",traditional:"true",contentType:"application/json; charset=utf-8",success:function(n){var i,t,r;if(n.Success){for($("#reportPreview").remove(),SavedSprite("#cloudSave"),OrderTablesLeft(),i='<div class="table-responsive table-report-view" id="reportPreview" style="z-index: 61;"><span class="remove-preview psuedo-link text-rsred" onclick="$(this).parent().remove();">&times;<\/span><table class="table table-striped table-report-view"><thead id="reportHeaders"><tr>',t=0;t<n.Data.Headers.length;t++)i+="<th>"+n.Data.Headers[t]+"<\/th>";for(i+="<\/thead><tbody>",t=0;t<n.Data.Rows.length;t++){for(i+="<tr>",r=0;r<n.Data.Rows[t].length;r++)i+="<td>"+n.Data.Rows[t][r]+"<\/td>";i+="<\/tr>"}i+="<\/tbody><\/table><\/div>";$(".report-work-area").append(i)}else SaveError("#cloudSave"),$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">'+n.Message+"<\/div><\/div>"),$("#informationModal").modal("show")},error:function(){SaveError("#cloudSave");$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">Internal Server Error<\/div><\/div>');$("#informationModal").modal("show")}})}function SaveReportType(){SaveSprite("#cloudSave");var n=parseInt($("#reportType").val());$.ajax({url:"../RSCloud/UpdateReportType",type:"post",data:JSON.stringify({company:CurrentCompany,report:ReportId,reportType:n}),dataType:"json",traditional:"true",contentType:"application/json; charset=utf-8",success:function(t){t.Success?(SavedSprite("#cloudSave"),report.ModificationToken=t.ModificationToken,modifiedCode=t.ModificationToken,report.ReportType=n,GetAvailableTables()):(SaveError("#cloudSave"),$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">'+t.Message+"<\/div><\/div>"),$("#informationModal").modal("show"))},error:function(){SaveError("#cloudSave");$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">Internal Server Error<\/div><\/div>');$("#informationModal").modal("show")}})}var report,modifiedCode="00000000-0000-0000-0000-000000000000",tableDrag=!1,tableDragging=null,startX=-1,startY=-1,cursorOffsetX=-1,cursorOffsetY=-1,availableTables=[{Name:"Name",UId:"00000000-0000-0000-0000-000000000000"}],sqlHeaderHtml='<div id="sqlHeaderInfo" class="form-group col-sm-12"><div class="row"><label class="control-label col-sm-4 col-sm-offset-1">Form Header<\/label><div class="col-sm-6"><select class="form-control" id="formVariable"><\/select><\/div><\/div><div class="row"><label class="col-sm-4 control-label col-sm-offset-1">Report Header<\/label> <div class="col-sm-6"><select class="form-control" id="reportHeader"><\/select><\/div><\/div><div class="row"><div class="col-sm-4 col-sm-offset-5"><button id="btnDataSave" class="btn btn-default">Save<\/button><\/div><\/div>',header=null,headerId=-1,tableContext={UId:"",Id:-1},headerContext={UId:"",Id:-1};$(document).ready(function(){SaveSprite("#cloudSave");$.ajax({url:"../RSCloud/GetReport",type:"post",data:{cid:CurrentCompany,rid:ReportId},dataType:"json",traditional:"true",success:function(n){var o,s,i,t,f,r,e,u;if(n.Success){SavedSprite("#cloudSave");report=n.Report;$("#name").val(report.Name).trigger("change");o='<div class="form-group col-sm-12"><label class="control-label col-sm-8">Type<\/label><div class="col-sm-4"><select class="form-control" id="reportType"><option value="0">Data<\/option><option value="1">Inventory<\/option><\/select><\/div><\/div>';$("#reportTypeDiv").html(o);$("#reportType").val(n.Report.ReportType).on("change",function(){SaveReportType()});for(s=$("#mainHolder > section"),i='<div class="table-responsive"><table class="table table-striped table-report-headers"><thead id="reportHeaders"><tr><th><\/th>',t=0;t<report.Headers.length;t++)i+='<th class="report-header report-table-header-editable report-header" data-id="'+report.Headers[t].UId+'">'+report.Headers[t].Name+"<\/th>";for(i+='<\/tr><\/thead><tbody class="report-table-body"><\/tbody><\/table><\/div>',i+='<div class="report-work-area"><div class="report-work-align-left text-white">Align Tables Left<\/div>',i+='<div class="report-work-preview text-white">Preview Table<\/div>',t=0;t<report.Tables.length;t++)i+='<div class="report-table" data-table-uid="'+report.Tables[t].UId+'"><div class="row"><div class="table-title col-sm-12">'+report.Tables[t].Name+"<\/div><\/div><\/div>";for(i+="<\/div>",s.html(i),t=0;t<report.Tables.length;t++){for(f='<tr data-table-sql-uid="'+report.Tables[t].TableUId+'" data-table-uid="'+report.Tables[t].UId+'"><td class="report-form">'+report.Tables[t].Name+'<input type="hidden" id="filtersData" /><span class="psuedo-link table-filter text-rsred"><span class="glyphicon glyphicon-filter"><\/span><\/span><\/td>',r=0;r<report.Headers.length;r++){for(e=!1,u=0;u<report.Tables[t].Headers.length;u++)if(report.Tables[t].Headers[u].ReportHeaderUId==report.Headers[r].UId){f+='<td class="report-table-header-editable table-header" data-report-header-uid="'+report.Headers[r].UId+'" data-table-header-uid="'+report.Tables[t].Headers[u].UId+'">'+report.Tables[t].Headers[u].Name+"<\/td>";e=!0;break}e||(f+='<td data-report-header-uid="'+report.Headers[r].UId+'" data-table-header-uid="" class="report-table-header-editable table-header table-header-empty"><\/td>')}f+="<\/tr>";$(".report-table-body").append(f)}$(".report-work-align-left").on("click",function(){OrderTablesLeft()});$(".report-work-preview").on("click",function(){PreviewTable()});OrderTablesLeft();GetAvailableTables();StartDrag();ClickHeaders()}else SaveError("#cloudSave"),$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">'+n.Message+"<\/div><\/div>"),$("#informationModal").modal("show")},error:function(){SaveError("#cloudSave");$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">Internal Server Error<\/div><\/div>');$("#informationModal").modal("show")}});setTimeout(function(){GetModificationToken()},2e4);$("#newHeader").on("click",function(){var n=report.Headers.length+1;header={Id:-1,UId:"00000000-0000-0000-0000-000000000000",Company:CurrentCompany,Name:"NewHeader",DateCreated:null,DateModified:null,Owner:"00000000-0000-0000-0000-000000000000",Group:"00000000-0000-0000-0000-000000000000",Permission:"755",Type:"ReportHeader",ReportUId:ReportId,Styling:null,Position:n};$("#newHeaderModal").modal("show")});$("#saveNewHeader").on("click",function(){SaveNewHeader()});$("#name").on("toggle-edit-change",function(){var n=$(this).val();SaveReportName(n)});$("#newTable").on("click",function(){$("#newTableModal").modal("show")});$("#saveNewTable").on("click",function(){SaveNewTable()});$(document).on("click contextmenu",function(){$(".context-menu").hide()});$("#removeHeader").on("click",function(){SaveSprite("#cloudSave");$.ajax({url:"../RSCloud/RemoveReportHeader",type:"post",data:{cid:CurrentCompany,rid:ReportId,rhid:headerContext.UId},dataType:"json",traditional:"true",success:function(n){var t,i;if(SavedSprite("#cloudSave"),n.Success){for(t=0;t<report.Headers.length;t++)if(report.Headers[t].UId==n.Header.UId){report.Headers.splice(t,1);break}for(t=0;t<report.Tables.length;t++)for(i=0;i<report.Tables[t].Headers.length;i++)if(report.Tables[t].Headers[i].ReportHeaderUId==n.Header.UId){report.Tables[t].Headers.splice(i,1);break}$('[data-id="'+n.Header.UId+'"], [data-report-header-uid="'+n.Header.UId+'"').remove();GetAvailableTables();StartDrag();ClickHeaders()}else SaveError("#cloudSave"),$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">'+n.Message+"<\/div><\/div>"),$("#informationModal").modal("show")},error:function(){SaveError("#cloudSave");$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">Internal Server Error<\/div><\/div>');$("#informationModal").modal("show")}})});$("#removeForm").on("click",function(){SaveSprite("#cloudSave");$.ajax({url:"../RSCloud/RemoveReportTable",type:"post",data:{cid:CurrentCompany,rid:ReportId,rtid:tableContext.UId},dataType:"json",traditional:"true",success:function(n){var t,i;if(n.Success){for(SavedSprite("#cloudSave"),t=0;t<report.Tables.length;t++)if(report.Tables[t].UId==n.TableUId){report.Tables.splice(t,1);break}i=$('tr[data-table-uid="'+n.TableUId+'"]');i.children("td, th").animate({padding:0}).wrapInner("<div />").children().slideUp(function(){i.remove()});$('.report-table[data-table-uid="'+n.TableUId+'"]').remove();GetAvailableTables();StartDrag();ClickHeaders()}else SaveError("#cloudSave"),$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">'+n.Message+"<\/div><\/div>"),$("#informationModal").modal("show")},error:function(){SaveError("#cloudSave");$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">Internal Server Error<\/div><\/div>');$("#informationModal").modal("show")}})});$("#removeTableHeader").on("click",function(){var n=$('td[data-table-header-uid="'+headerContext.UId+'"]');n.hasClass("table-header-empty")||(SaveSprite(),$.ajax({url:"../RSCloud/RemoveTableHeader",type:"post",data:JSON.stringify({company:CurrentCompany,report:ReportId,table:tableContext.UId,header:headerContext.UId}),dataType:"json",traditional:"true",contentType:"application/json; charset=utf-8",success:function(t){var i,r;if(SavedSprite(),t.Success){for(i=0;i<report.Tables.length;i++)if(report.Tables[i].UId==t.TableUId)for(r=0;r<report.Tables[i].Headers.length;r++)if(report.Tables[i].Headers[r].UId==t.HeaderUId){report.Tables[i].Headers.splice(r,1);break}SavedSprite("#cloudSave");n.attr("data-table-header-uid","");n.wrapInner("<div><\/div>");n.children("div").slideUp(function(){n.html("").addClass("table-header-empty");n.find("div").remove()})}else SaveError("#cloudSave"),$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">'+t.Message+"<\/div><\/div>"),$("#informationModal").modal("show")},error:function(){SaveError("#cloudSave");$("#informationModal .modal-body").html('<div class="row"><div class="col-sm-10 col-sm-offset-1">Internal Server Error<\/div><\/div>');$("#informationModal").modal("show")}}))});$("#previewReport").on("click",function(){window.open("ViewReport?cid="+CurrentCompany+"&rid="+ReportId)})});
//# sourceMappingURL=EditReport.min.js.map
