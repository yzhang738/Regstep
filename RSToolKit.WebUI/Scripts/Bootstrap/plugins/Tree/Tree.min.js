(function(n){var o="tree_hidden_div",h="Folder/Move",c="put",l="Folder/Folder",a="post",v="Folder/Folder",y="put",p="Folder/Folder",w="delete",s="Node/Node",b="Node/Node",k="delete",r,i,u,t,f,e;n("body").append('<div style="display: none" id="'+o+'"><\/div>');r=document.createElement("link");r.setAttribute("rel","stylesheet");r.setAttribute("type","text/css");r.setAttribute("href","../../Content/Bootstrap/Tree.min.css");document.getElementsByTagName("head")[0].appendChild(r);i=0;u='<div class="modal fade"><div class="modal-dialog"><div class="modal-header"><h3 class="modal-title">Folder Select<\/h3><\/div>';u+='<div class="modal-body"><div class="row"><div class="col-sm-12 folder-select-body"><\/div><\/div><\/div>';u+='<div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Cancel<\/button><button class="tree-folderselect-save btn btn-default">Set<\/button><\/div><\/div><\/div>';t='<div class="tree-context" style="display: none;">';t+='<ul class="tree-context-group tree-context-group-folder">';t+='<li class="tree-context-folder-edit tree-context-item">Edit<\/li>';t+='<li class="tree-context-folder-delete tree-context-item">Delete<\/li>';t+='<li class="tree-context-folder-move tree-context-item">Move<\/li>';t+='<li class="tree-context-folder-new tree-context-item">New Folder<\/li>';t+="<\/ul>";t+='<ul class="tree-context-group tree-context-group-node">';t+='<li class="tree-context-node-edit tree-context-item">Edit<\/li>';t+='<li class="tree-context-node-delete tree-context-item">Delete<\/li>';t+='<li class="tree-context-node-move tree-context-item">Move<\/li>';t+='<li class="tree-context-node-copy tree-context-item">Copy<\/li>';t+="<\/ul>";t+="<\/div>";f='<div class="modal fade"><div class="modal-dialog"><div class="modal-header"><h3 class="modal-title">New Folder<\/h3><\/div>';f+='<div class="modal-body"><div class="row"><div class="col-sm-12 folder-select-body"><input type="text" class="new-folder-name form-control" placeholder="Folder Name" /><\/div><\/div><\/div>';f+='<div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Cancel<\/button><button class="tree-newFolder-save btn btn-default">Create<\/button><\/div><\/div><\/div>';e='<div class="modal fade"><div class="modal-dialog"><div class="modal-header"><h3 class="modal-title">Edit Folder<\/h3><\/div>';e+='<div class="modal-body"><div class="row"><div class="col-sm-12 folder-select-body"><input type="text" class="edit-folder-name form-control" placeholder="Folder Name" /><\/div><\/div><\/div>';e+='<div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Cancel<\/button><button class="tree-editFolder-save btn btn-default">Update<\/button><\/div><\/div><\/div>';n.fn.tree=function(r){var d=n.extend({allowNodeEdit:!0,allowNodeMove:!0,allowFolderEdit:!0,allowFolderMove:!0,allowFolderDelete:!0,allowNodeDelete:!0,showButtons:!1,allowNewFolder:!0},r);this.each(function(){function ft(t,u){t.stopPropagation();temp_item=u;r.append(n(".tree-context-group[data-tree-context="+i+"]"));temp_item.hasClass("tree-folder")?(tt=temp_item.attr("id"),r.children("ul").not(".tree-context-group-folder").appendTo("#"+o),temp_item.closest("ul").parent().hasClass("tree")?r.find(".tree-context-folder-move").hide():r.find(".tree-context-folder-move").show()):(it=temp_item.attr("id"),r.children("ul").not(".tree-context-group-node").appendTo("#"+o));t.preventDefault();r.css("left",t.pageX).css("top",t.pageY);r.show()}var rt,r,g,ut;i++;var tt=null,it=null,nt=n(this);nt.attr("unselectable","on").css("user-select","none").on("selectstart",!1);if(rt=n(e),d.allowFolderEdit){n("body").append(rt);rt.find(".tree-editFolder-save").on("click",function(){var r=n("#"+tt),u=g.find('.tree-folder[data-tree-folder-id="'+tt+'"]'),t,i;rt.modal("hide");processing.showPleaseWait();t=new XMLHttpRequest;i={id:tt,name:rt.find(".edit-folder-name").val()};AddJsonAntiForgeryToken(i);t.onerror=function(){processing.hidePleaseWait();alert("Unhandled Server Error")};t.onload=function(n){if(processing.hidePleaseWait(),n.currentTarget.status==200){var f=JSON.parse(t.responseText);f.Success?(r.children(".tree-item-name").text(i.name),u.children(".tree-item-name").text(i.name)):alert(f.Message)}else alert("Unhandled Server Error")};t.open(y,v,!0);t.setRequestHeader("Content-Type","application/json");t.send(JSON.stringify(i))})}if(r=n(t),n("body").append(r),r.attr("id","tree_context_"+i),r.children("ul").attr("data-tree-context",i),g=null,d.allowNodeMove||d.allowFolderMove){ut=nt.clone();g=n(u);g.attr("id","tree_modal_"+i);n("body").append(g);ut.find(".tree-node").closest("li").remove();ut.find(".tree-folder").each(function(){var t=n(this).attr("id");n(this).attr("data-tree-folder-id",t);n(this).attr("id","");n(this).append('<span class="tree-folder-select">Select<\/span>')});g.find(".folder-select-body").append(ut);ut.find(".tree-folder-select").on("click",function(t){t.preventDefault();t.stopPropagation();var i=n(this).closest(".tree-folder").attr("data-tree-folder-id");ut.find(".tree-folder-select").not("#"+i).text("Select");n(this).text("Selected");g.data("tree-folder",i)});n("li.parent_li",ut).find(" > ul > li").hide();g.find(".tree-folderselect-save").on("click",function(){g.modal("hide");processing.showPleaseWait();var t=new XMLHttpRequest,i={id:g.data("tree-item"),targetFolder:g.data("tree-folder")};AddJsonAntiForgeryToken(i);t.onerror=function(){processing.hidePleaseWait();alert("Unhandled Server Error")};t.onload=function(i){var r,o,s;if(processing.hidePleaseWait(),i.currentTarget.status==200)if(r=JSON.parse(t.responseText),r.Success){var u=g.data("tree-item"),f=g.data("tree-folder"),e=n("#"+u).closest("li"),h=n("#"+f).closest("li").children("ul");h.append(e);e.children("span").is(".tree-folder")&&(o=n('.tree-folder[data-tree-folder-id="'+u+'"]').closest("li"),s=n('.tree-folder[data-tree-folder-id="'+f+'"]').closest("li").children("ul"),s.append(o))}else alert(r.Message);else alert("Unhandled Server Error")};t.open(c,h,!0);t.setRequestHeader("Content-Type","application/json");t.send(JSON.stringify(i))})}nt.hasClass("tree")||nt.addClass("tree");nt.data("tree-id",tree);n("li:has(ul)",nt).addClass("parent_li").find(" > .tree-haschildren").attr("title","Collapse this branch");n("li.parent_li",nt).find(" > ul > li").hide();n("li.parent_li > span",nt).on("click",function(t){var i=n(this).parent("li.parent_li").find(" > ul > li");i.is(":visible")?(i.hide("fast"),n(this).attr("title","Expand this branch").find(".glyphicon").addClass("glyphicon-folder-close").removeClass("glyphicon-folder-open")):(i.show("fast"),n(this).attr("title","Collapse this branch").find(".glyphicon").addClass("glyphicon-folder-open").removeClass("glyphicon-folder-close"));t.stopPropagation()});if(d.allowFolderMove||d.allowNodeMove){n("li:has(ul)",g).addClass("parent_li").find(" > .tree-haschildren").attr("title","Collapse this branch");n("li.parent_li",g).find(" > ul > li").hide();n("li.parent_li > span",g).on("click",function(t){var i=n(this).parent("li.parent_li").find(" > ul > li");i.is(":visible")?(i.hide("fast"),n(this).attr("title","Expand this branch").find(".glyphicon").addClass("glyphicon-folder-close").removeClass("glyphicon-folder-open")):(i.show("fast"),n(this).attr("title","Collapse this branch").find(".glyphicon").addClass("glyphicon-folder-open").removeClass("glyphicon-folder-close"));t.stopPropagation()})}if(d.allowFolderEdit)r.find(".tree-context-folder-edit").on("click",function(t){t.stopPropagation();var i=n("#"+tt).children(".tree-item-name").text();rt.find(".edit-folder-name").val(i);rt.modal("show")});else r.find(".tree-context-folder-edit").remove();if(d.allowFolderMove){if(d.showButtons){n(".tree-folder").each(function(){n(this).append(' <a href="#" class="tree-folder-move"><span class="glyphicon glyphicon-move"><\/span><\/a>')});nt.find(".tree-folder-move, .tree-node-move").on("click",function(t){t.preventDefault();var i=n(this).closest(".parent_li").children(".tree-folder").attr("id"),r=n(this).closest(".tree-item").attr("id");g.data("tree-item",r);g.data("tree-folder",i);g.find(".tree-folder").not("#"+i).find(".tree-folder-select").text("Select");g.find("#"+i).find(".tree-folder-select").text("Selected");g.modal("show")})}r.find(".tree-context-folder-move").on("click",function(t){t.stopPropagation();var u=n("#"+tt).parent(),i=n(u).closest(".parent_li").children(".tree-folder").attr("id"),f=tt;g.data("tree-item",f);g.data("tree-folder",i);g.find(".tree-folder").not("#"+i).find(".tree-folder-select").text("Select");g.find("#"+i).find(".tree-folder-select").text("Selected");g.modal("show");r.hide()})}else r.find(".tree-context-folder-move").remove();if(d.allowNodeEdit){nt.find(".tree-node").on("dblclick",function(t){t.stopPropagation();window.location.href=s+"/"+n(this).attr("id")});d.showButtons&&n(".tree-node").each(function(){n(this).append(' <a href="'+s+"/"+n(this).attr("id")+'"><span class="glyphicon glyphicon-edit"><\/span><\/a>')});r.find(".tree-context-node-edit").on("click",function(n){n.stopPropagation();window.location.href=s+"/"+it})}else r.find(".tree-context-node-edit").remove();if(d.allowNodeMove){d.showButtons&&n(".tree-node").each(function(){n(this).append(' <a href="#" class="tree-node-move"><span class="glyphicon glyphicon-move"><\/span><\/a>')});r.find(".tree-context-node-move").on("click",function(t){t.stopPropagation();var u=n("#"+it),i=n(u).closest(".parent_li").children(".tree-folder").attr("id"),f=it;g.data("tree-item",f);g.data("tree-folder",i);g.find(".tree-folder").not("#"+i).find(".tree-folder-select").text("Select");g.find("#"+i).find(".tree-folder-select").text("Selected");g.modal("show");r.hide()})}else nt.find(".tree-context-node-move").remove();if(d.allowNodeDelete)r.find(".tree-context-node-delete").on("click",function(t){var f,i,u;(t.stopPropagation(),r.hide(),f=n("#"+it).closest("li"),confirm("Deleting an item cannot be undone? Do you want to continue."))&&(processing.showPleaseWait(),i=new XMLHttpRequest,u={id:it},AddJsonAntiForgeryToken(u),i.onerror=function(){processing.hidePleaseWait();alert("Unhandled Server Error")},i.onload=function(n){if(processing.hidePleaseWait(),n.currentTarget.status==200){var t=JSON.parse(i.responseText);t.Success?f.remove():alert(t.Message)}else alert("Unhandled Server Error")},i.open(k,b,!0),i.setRequestHeader("Content-Type","application/json"),i.send(JSON.stringify(u)))});else r.find(".tree-context-node-delete").remove();if(d.allowFolderDelete)r.find(".tree-context-folder-delete").on("click",function(t){var f,i,u;(t.stopPropagation(),r.hide(),f=n("#"+tt).closest("li"),confirm("Deleting an item cannot be undone? Do you want to continue."))&&(processing.showPleaseWait(),i=new XMLHttpRequest,u={id:tt},AddJsonAntiForgeryToken(u),i.onerror=function(){processing.hidePleaseWait();alert("Unhandled Server Error")},i.onload=function(n){if(processing.hidePleaseWait(),n.currentTarget.status==200){var t=JSON.parse(i.responseText);t.Success?f.remove():alert(t.Message)}else alert("Unhandled Server Error")},i.open(w,p,!0),i.setRequestHeader("Content-Type","application/json"),i.send(JSON.stringify(u)))});else r.find(".tree-context-folder-delete").remove();r.find(".tree-context-node-copy").on("click",function(t){var f,i,u;t.stopPropagation();r.hide();f=n("#"+it).closest("li");processing.showPleaseWait();i=new XMLHttpRequest;u={key:it};AddJsonAntiForgeryToken(u);i.onerror=function(){processing.hidePleaseWait();alert("Unhandled Server Error")};i.onload=function(n){if(processing.hidePleaseWait(),n.currentTarget.status==200){var t=JSON.parse(i.responseText);t.Success?window.location.href=t.Location:alert(t.Message)}else alert("Unhandled Server Error")};i.open("post","Node/Copy",!0);i.setRequestHeader("Content-Type","application/json");i.send(JSON.stringify(u))});nt.find(".tree-item").on("contextmenu",function(t){ft(t,n(this))});if(d.allowNewFolder){t_newFolderModal=n(f);t_newFolderModal.attr("id","tree_"+i+"_newFolder");r.find(".tree-context-folder-new").on("click",function(){t_newFolderModal.find(".new-folder-name").val("");t_newFolderModal.modal("show")});t_newFolderModal.find(".tree-newFolder-save").on("click",function(t){var i,u,r;t_newFolderModal.modal("hide");processing.showPleaseWait();i=t_newFolderModal.find(".new-folder-name").val();(typeof i=="undefined"||i===null||i==="")&&(i="New Folder");t.stopPropagation();t.preventDefault();u=tt;fs_data={parent:tt,name:i};AddJsonAntiForgeryToken(fs_data);r=new XMLHttpRequest;r.onerror=function(){processing.hidePleaseWait();alert("Unhandled Server Error")};r.onload=function(t){var f;if(t.currentTarget.status==200)if(f=JSON.parse(r.responseText),f.Success){var e=f.Id,o=n("#"+u).parent().children("ul"),h='<li class="parent_li"><span id="'+e+'" class="tree-folder tree-item tree-haschildren"><span class="glyphicon glyphicon-folder-close"><\/span><span class="tree-item-name">'+i+'<\/span><\/span><ul><\/ul><\/li>"',s=n(h);o.append(s);s.find(".tree-folder").on("contextmenu",function(t){ft(t,n(this))}).on("click",function(t){var i=n(this).parent("li.parent_li").find(" > ul > li");i.is(":visible")?(i.hide("fast"),n(this).attr("title","Expand this branch").find(".glyphicon").addClass("glyphicon-folder-close").removeClass("glyphicon-folder-open")):(i.show("fast"),n(this).attr("title","Collapse this branch").find(".glyphicon").addClass("glyphicon-folder-open").removeClass("glyphicon-folder-close"));t.stopPropagation()});g.find('.tree-folder[data-tree-folder-id="'+o+'"]').append('<li><span data-tree-folder-id="'+e+'">'+name+"<\/span><ul><\/ul><li>");processing.hidePleaseWait()}else processing.hidePleaseWait(),alert(f.Message)};r.open(a,l,!0);r.setRequestHeader("Content-Type","application/json");r.send(JSON.stringify(fs_data))})}else r.find(".tree-context-folder-new").remove();n("html").on("click",function(){r.hide()});n("html").on("contextmenu",function(){r.hide()})})}})(jQuery);
//# sourceMappingURL=Tree.min.js.map
